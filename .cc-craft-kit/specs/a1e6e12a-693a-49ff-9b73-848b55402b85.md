# git clone せずともインストールできるようにしたい

**仕様書 ID:** a1e6e12a-693a-49ff-9b73-848b55402b85
**フェーズ:** completed
**作成日時:** 2025/11/17 18:17:32
**更新日時:** 2025/11/17 18:44:40

---

## 1. 背景と目的

### 背景

現在の Takumi インストール方法は以下の手順が必要です。

1. Git リポジトリをクローン: `git clone https://github.com/owner/takumi.git`
2. ディレクトリ移動: `cd takumi`
3. 依存関係インストール: `npm install`
4. ビルド実行: `npm run build`
5. ドッグフーディング環境へ同期: `npm run sync:dogfood`

この手順は以下の問題があります。

- **Git 操作のハードル**: Git に不慣れなユーザーにとって、clone 操作は心理的障壁が高い
- **手順の煩雑さ**: 5 ステップの手動実行が必要で、途中でエラーが発生しやすい
- **環境依存性**: Git、Node.js、npm のバージョンによって動作が異なる可能性がある

### 目的

**インストールスクリプトのみ**で、指定したプロジェクトディレクトリに Takumi を導入できるようにします。

以下のような使い方を実現します。

```bash
# 指定したプロジェクトディレクトリにインストール
curl -fsSL https://takumi.dev/install.sh | sh -s -- /path/to/my-project

# カレントディレクトリにインストール
curl -fsSL https://takumi.dev/install.sh | sh

# プロジェクト名を指定して新規ディレクトリ作成 + インストール
curl -fsSL https://takumi.dev/install.sh | sh -s -- --project my-new-project
```

これにより、以下を実現します。

- Git 操作なしで、任意のプロジェクトに Takumi を導入
- npm パッケージ公開前でも利用可能（GitHub Releases からダウンロード）
- CI/CD 環境での自動セットアップが容易

---

## 2. 対象ユーザー

### プライマリユーザー

- **Git 初心者**: コマンドライン操作に不慣れな開発者
- **試用ユーザー**: Takumi をすぐに試したいユーザー
- **CI/CD 管理者**: 自動セットアップスクリプトで導入したいユーザー

### セカンダリユーザー

- **既存ユーザー**: 新しいプロジェクトへの導入を簡略化したいユーザー
- **チーム開発者**: チーム全体での統一的なセットアップ手順が必要なユーザー

---

## 3. 受け入れ基準

### 必須要件

- [ ] `curl -fsSL https://takumi.dev/install.sh | sh` でカレントディレクトリへのインストールが完了すること
- [ ] `curl -fsSL https://takumi.dev/install.sh | sh -s -- /path/to/project` で指定ディレクトリへのインストールが完了すること
- [ ] インストール完了後、`/cft:status` コマンドが正常に動作すること
- [ ] Git 操作なしでインストールが完了すること
- [ ] Node.js 18 以上で動作すること
- [ ] インストールスクリプトは GitHub Releases から最新の成果物をダウンロードすること

### 機能要件

- [ ] インストールスクリプト `install.sh` を提供すること
- [ ] スクリプトは以下の引数をサポートすること
  - 引数なし: カレントディレクトリにインストール
  - パス指定: 指定したディレクトリにインストール
  - `--project <name>`: 新規ディレクトリを作成してインストール
  - `--version <version>`: 特定バージョンをインストール（デフォルトは最新版）
- [ ] GitHub Releases から最新の `.cc-craft-kit/` ディレクトリ一式をダウンロードすること
- [ ] `.cc-craft-kit/` ディレクトリが自動的に作成されること
- [ ] `.env.example` から `.env` が自動生成されること
- [ ] シンボリックリンク `.claude/commands/takumi/` が自動作成されること
- [ ] インストール時にプロジェクト名、説明を対話的に入力できること（オプション）
- [ ] `/cft:init` コマンドを自動実行して、プロジェクトデータベースを初期化すること
- [ ] `README.md` がない場合、自動生成してクイックスタートガイドを含めること

### 非機能要件

- [ ] インストール時間は 30 秒以内であること
- [ ] オフラインでのインストールは不要（npm キャッシュに依存）
- [ ] エラーメッセージは日本語で表示されること
- [ ] インストールログは `.cc-craft-kit/install.log` に記録されること
- [ ] Windows、macOS、Linux すべてで動作すること

---

## 4. 制約条件

### 技術的制約

- Node.js 18 以上が必須
- npm 9 以上が必須
- シンボリックリンク作成のため、Windows では開発者モードまたは管理者権限が必要

### 配布制約

- GitHub Releases への成果物アップロードが必要
- インストールスクリプトは GitHub Pages または CDN でホスティング
- セマンティックバージョニング（SemVer）に従うこと
- タグベースのリリース管理（例: `v1.0.0`）

### セキュリティ制約

- インストールスクリプトは HTTPS 経由でのみ配布
- インストール時に外部スクリプトを実行しない
- ユーザーの環境変数を勝手に変更しない

---

## 5. 依存関係

### 前提条件

- GitHub Releases への成果物アップロードパイプライン構築（CI/CD）
- GitHub Pages または CDN のセットアップ（スクリプトホスティング用）
- ビルド済み `.cc-craft-kit/` ディレクトリの tar.gz アーカイブ作成

### 依存する他の仕様

- なし（新規機能）

### この仕様に依存する将来の機能

- Takumi アップデート機能（`/cft:upgrade`）
- プラグインマーケットプレイス
- テンプレートギャラリー（プロジェクト初期化時に選択）

---

## 6. 参考情報

### 類似ツールのインストール方法

- **Rust (rustup)**: `curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh`
- **Homebrew**: `curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh | bash`
- **Oh My Zsh**: `curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh | sh`
- **nvm**: `curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash`

### 参考ドキュメント

- [GitHub Releases API](https://docs.github.com/en/rest/releases/releases)
- [GitHub Pages](https://docs.github.com/en/pages)
- [Shell Script Best Practices](https://google.github.io/styleguide/shellguide.html)
- [Bash Piping with curl](https://www.idontplaydarts.com/2016/04/detecting-curl-pipe-bash-server-side/)

---

## 7. インストールスクリプトの詳細仕様

### 基本動作

1. GitHub Releases API から最新バージョン情報を取得
2. `.cc-craft-kit.tar.gz` アーカイブをダウンロード
3. 指定されたディレクトリに展開
4. `.env.example` から `.env` を生成（既存の場合はスキップ）
5. シンボリックリンク `.claude/commands/takumi/` を作成
6. `/cft:init` コマンドを自動実行（プロジェクト初期化）
7. インストール完了メッセージと次のステップを表示

### 引数パターン

| 引数 | 動作 | 例 |
|---|---|---|
| なし | カレントディレクトリにインストール | `curl ... \| sh` |
| パス指定 | 指定ディレクトリにインストール | `sh -s -- /path/to/project` |
| `--project <name>` | 新規ディレクトリ作成 + インストール | `sh -s -- --project my-app` |
| `--version <ver>` | 特定バージョンをインストール | `sh -s -- --version v1.0.0` |
| `--help` | ヘルプメッセージ表示 | `sh -s -- --help` |

### エラーハンドリング

- Node.js 未インストール → エラーメッセージ + インストール案内
- npm 未インストール → エラーメッセージ + インストール案内
- `.cc-craft-kit/` 既存 → 上書き確認プロンプト（デフォルト: スキップ）
- ネットワークエラー → リトライ案内
- GitHub API レート制限 → 代替ダウンロード URL 案内

### インストール方法の比較

| 方法 | コマンド例 | メリット | デメリット |
|---|---|---|---|
| **インストールスクリプト（本仕様）** | `curl -fsSL https://takumi.dev/install.sh \| sh` | Git 不要、npm パッケージ不要、環境変数設定も自動化 | セキュリティリスク（実行前に内容確認推奨） |
| **従来の git clone** | `git clone ...` | ソースコード編集可能 | 手順が煩雑、初心者に不向き |

---

## 8. 実装スコープ

### Phase 1（MVP）

- `install.sh` スクリプトの開発
- GitHub Releases への `.cc-craft-kit.tar.gz` アップロード自動化（CI/CD）
- 基本的なインストールフロー（カレントディレクトリ、パス指定）
- エラーハンドリング（Node.js/npm チェック、既存ディレクトリチェック）

### Phase 2（機能拡張）

- `--project` オプション（新規ディレクトリ作成）
- `--version` オプション（特定バージョン指定）
- 対話型プロジェクト初期化（プロジェクト名、説明の入力）
- README.md 自動生成

### Phase 3（将来構想）

- アップデート機能（`/cft:upgrade`）
- テンプレート選択機能
- プラグインプリインストール

---

## 9. アーキテクチャ設計

### 全体構成

```text
┌──────────────────────────────────────────────────────────────┐
│                        ユーザー環境                           │
│                                                              │
│  curl -fsSL https://takumi.dev/install.sh | sh              │
│                           │                                  │
│                           ▼                                  │
│  ┌─────────────────────────────────────────────────┐        │
│  │            install.sh                           │        │
│  │  1. 環境チェック (Node.js/npm)                 │        │
│  │  2. GitHub Releases API へリクエスト           │        │
│  │  3. .cc-craft-kit.tar.gz ダウンロード                │        │
│  │  4. ディレクトリ展開                            │        │
│  │  5. .env 生成                                   │        │
│  │  6. シンボリックリンク作成                      │        │
│  │  7. /cft:init 実行                           │        │
│  └─────────────────────────────────────────────────┘        │
│                           │                                  │
│                           ▼                                  │
│  ┌─────────────────────────────────────────────────┐        │
│  │         プロジェクトディレクトリ                │        │
│  │  .cc-craft-kit/                                       │        │
│  │  ├── commands/                                  │        │
│  │  ├── core/                                      │        │
│  │  ├── integrations/                              │        │
│  │  └── cc-craft-kit.db                                  │        │
│  │  .claude/commands/takumi/ (symlink)             │        │
│  │  .env                                           │        │
│  └─────────────────────────────────────────────────┘        │
└──────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────┐
│                      GitHub Ecosystem                        │
│                                                              │
│  ┌────────────────────┐     ┌──────────────────────┐        │
│  │  GitHub Actions    │────▶│  GitHub Releases     │        │
│  │  (CI/CD)           │     │  - .cc-craft-kit.tar.gz    │        │
│  │  1. npm run build  │     │  - CHANGELOG.md      │        │
│  │  2. tar.gz 作成    │     └──────────────────────┘        │
│  │  3. アップロード   │              │                       │
│  └────────────────────┘              │                       │
│                                      │                       │
│  ┌────────────────────┐              │                       │
│  │  GitHub Pages      │◀─────────────┘                       │
│  │  (CDN)             │                                      │
│  │  https://takumi.dev/install.sh                            │
│  └────────────────────┘                                      │
└──────────────────────────────────────────────────────────────┘
```

### コンポーネント設計

#### 1. `install.sh`（インストールスクリプト）

**責務:**
- 環境チェック（Node.js、npm、OS 検出）
- GitHub Releases API からの最新バージョン取得
- アーカイブのダウンロードと展開
- 初期設定（.env 生成、シンボリックリンク作成）
- プロジェクト初期化（`/cft:init` 実行）

**主要関数:**
```bash
check_prerequisites()  # 環境チェック
detect_os()            # OS検出
fetch_latest_version() # 最新バージョン取得
download_archive()     # アーカイブダウンロード
extract_archive()      # 展開
create_symlink()       # シンボリックリンク作成
generate_env()         # .env生成
init_project()         # プロジェクト初期化
show_success()         # 成功メッセージ表示
```

#### 2. GitHub Actions ワークフロー（`.github/workflows/release.yml`）

**責務:**
- タグプッシュをトリガーにリリースを自動化
- ビルド成果物の作成（`npm run build`）
- `.cc-craft-kit/` ディレクトリのアーカイブ化（tar.gz）
- GitHub Releases へのアップロード
- `install.sh` の GitHub Pages へのデプロイ

**ワークフロー:**
```yaml
on:
  push:
    tags:
      - 'v*.*.*'

jobs:
  release:
    - npm install
    - npm run build
    - npm run sync:dogfood
    - tar -czf .cc-craft-kit.tar.gz .cc-craft-kit/
    - GitHub Release 作成
    - .cc-craft-kit.tar.gz アップロード
    - install.sh を GitHub Pages へデプロイ
```

#### 3. プロジェクト構成

**インストール後のディレクトリ構成:**
```text
/path/to/my-project/
├── .cc-craft-kit/
│   ├── commands/          # Takumi CLIコマンド
│   ├── core/              # コアロジック
│   ├── integrations/      # GitHub連携
│   ├── cc-craft-kit.db          # SQLiteデータベース
│   └── install.log        # インストールログ
├── .claude/
│   └── commands/
│       └── takumi/        # シンボリックリンク → .cc-craft-kit/commands/
├── .env                   # 環境変数（自動生成）
└── README.md              # クイックスタートガイド（オプション）
```

---

## 10. インストールスクリプト実装設計

### スクリプト構造の概要

**ファイル:** `scripts/install.sh`

**主要変数:**
```bash
TAKUMI_REPO="B16B1RD/takumi"
TAKUMI_BASE_URL="https://github.com/${TAKUMI_REPO}"
TAKUMI_RELEASES_API="https://api.github.com/repos/${TAKUMI_REPO}/releases/latest"
INSTALL_DIR="."
VERSION="latest"
LOG_FILE=".cc-craft-kit/install.log"
```

**主要関数の責務:**

| 関数名 | 責務 | 入力 | 出力 |
|---|---|---|---|
| `check_prerequisites()` | Node.js、npm、curl、tar の存在確認 | なし | エラー時に exit 1 |
| `detect_os()` | OS を検出（linux/macos/windows） | なし | OS 名（文字列） |
| `fetch_latest_version()` | GitHub Releases API から最新バージョン取得 | なし | `$LATEST_VERSION`, `$DOWNLOAD_URL` |
| `download_archive()` | `.cc-craft-kit.tar.gz` をダウンロード | なし | 一時ファイルパス |
| `extract_archive()` | アーカイブを展開 | 一時ファイルパス | なし |
| `create_symlink()` | シンボリックリンク作成 | なし | なし |
| `generate_env()` | `.env` ファイル生成 | なし | なし |
| `init_project()` | `/cft:init` 実行 | なし | なし |
| `show_success()` | 成功メッセージ表示 | なし | なし |

### エラーハンドリング設計

| エラーケース | 検出方法 | 処理 |
|---|---|---|
| Node.js 未インストール | `command -v node` | エラーメッセージ + インストール案内 |
| Node.js バージョン不足 | `node -v` | エラーメッセージ + 必要バージョン表示 |
| npm 未インストール | `command -v npm` | エラーメッセージ |
| curl 未インストール | `command -v curl` | エラーメッセージ |
| tar 未インストール | `command -v tar` | エラーメッセージ |
| GitHub API エラー | `curl` の終了コード | エラーメッセージ + リトライ案内 |
| ダウンロード失敗 | `curl` の終了コード | エラーメッセージ |
| `.cc-craft-kit/` 既存 | `[ -d .cc-craft-kit ]` | 上書き確認プロンプト |
| シンボリックリンク作成失敗 | `ln -s` の終了コード | 警告メッセージ（手動作成案内） |
| プロジェクト初期化失敗 | `npx tsx` の終了コード | 警告メッセージ（手動実行案内） |

### スクリプトの動作フロー

```text
main()
  ├─ 引数解析 (--project, --version, --help)
  ├─ check_prerequisites()
  │   ├─ Node.js チェック
  │   ├─ Node.js バージョンチェック
  │   ├─ npm チェック
  │   ├─ curl チェック
  │   └─ tar チェック
  ├─ fetch_latest_version()
  │   ├─ GitHub Releases API リクエスト
  │   ├─ tag_name 抽出
  │   └─ browser_download_url 抽出
  ├─ download_archive()
  │   ├─ mktemp で一時ファイル作成
  │   └─ curl でダウンロード
  ├─ extract_archive()
  │   ├─ .cc-craft-kit/ 既存チェック
  │   ├─ 上書き確認（yes/no）
  │   ├─ tar -xzf で展開
  │   └─ 一時ファイル削除
  ├─ create_symlink()
  │   ├─ .claude/commands/ 作成
  │   └─ ln -s でシンボリックリンク作成
  ├─ generate_env()
  │   ├─ .env 既存チェック
  │   └─ .cc-craft-kit/.env.example → .env コピー
  ├─ init_project()
  │   └─ npx tsx .cc-craft-kit/commands/init.ts 実行
  └─ show_success()
      └─ 成功メッセージと次のステップ表示
```

---

## 11. CI/CD パイプライン設計

### GitHub Actions ワークフロー

**ファイル:** `.github/workflows/release.yml`

```yaml
name: Release

on:
  push:
    tags:
      - 'v*.*.*'

jobs:
  release:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Build project
        run: npm run build

      - name: Sync to dogfood environment
        run: npm run sync:dogfood

      - name: Create archive
        run: |
          cd .cc-craft-kit
          tar -czf ../.cc-craft-kit.tar.gz .
          cd ..

      - name: Generate changelog
        id: changelog
        uses: metcalfc/changelog-generator@v4.0.1
        with:
          myToken: ${{ secrets.GITHUB_TOKEN }}

      - name: Create GitHub Release
        id: create_release
        uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: ${{ github.ref_name }}
          release_name: Release ${{ github.ref_name }}
          body: ${{ steps.changelog.outputs.changelog }}
          draft: false
          prerelease: false

      - name: Upload archive to release
        uses: actions/upload-release-asset@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          upload_url: ${{ steps.create_release.outputs.upload_url }}
          asset_path: ./.cc-craft-kit.tar.gz
          asset_name: .cc-craft-kit.tar.gz
          asset_content_type: application/gzip

      - name: Deploy install.sh to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./scripts
          destination_dir: .
          keep_files: false
```

### リリースフロー

```text
1. 開発者がタグをプッシュ
   git tag v1.0.0
   git push origin v1.0.0

2. GitHub Actions が自動実行
   ├─ npm ci
   ├─ npm run build
   ├─ npm run sync:dogfood
   ├─ tar -czf .cc-craft-kit.tar.gz .cc-craft-kit/
   ├─ GitHub Release 作成
   ├─ .cc-craft-kit.tar.gz アップロード
   └─ install.sh を GitHub Pages へデプロイ

3. ユーザーがインストール
   curl -fsSL https://takumi.dev/install.sh | sh
```

### GitHub Pages セットアップ

**設定手順:**
1. リポジトリ設定 → Pages
2. Source: GitHub Actions
3. Custom domain（オプション）: `takumi.dev`
4. HTTPS 強制を有効化

**公開URL:**
- デフォルト: `https://b16b1rd.github.io/takumi/install.sh`
- カスタムドメイン: `https://takumi.dev/install.sh`

---

## 12. データフロー設計

### インストールフロー

```text
┌────────────────────────────────────────────────────────────────┐
│                     ユーザー操作                                │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  curl -fsSL https://takumi.dev/install.sh | sh                 │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  1. check_prerequisites()                                      │
│     - Node.js 18+ チェック                                     │
│     - npm チェック                                              │
│     - curl/tar チェック                                         │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  2. fetch_latest_version()                                     │
│     - GitHub Releases API リクエスト                           │
│     - 最新バージョン取得 (tag_name)                            │
│     - ダウンロードURL取得 (browser_download_url)               │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  3. download_archive()                                         │
│     - curl で .cc-craft-kit.tar.gz をダウンロード                    │
│     - 一時ファイルに保存                                        │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  4. extract_archive()                                          │
│     - .cc-craft-kit/ 既存チェック → 上書き確認                       │
│     - tar -xzf で展開                                           │
│     - 一時ファイル削除                                          │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  5. create_symlink()                                           │
│     - .claude/commands/ ディレクトリ作成                        │
│     - ln -s で .cc-craft-kit/commands へリンク                        │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  6. generate_env()                                             │
│     - .env 既存チェック                                         │
│     - .cc-craft-kit/.env.example を .env へコピー                     │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  7. init_project()                                             │
│     - npx tsx .cc-craft-kit/commands/init.ts 実行                    │
│     - cc-craft-kit.db 初期化                                          │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  8. show_success()                                             │
│     - インストール完了メッセージ                                │
│     - 次のステップ案内                                          │
└────────────────────────────────────────────────────────────────┘
```

### GitHub Releases 配布フロー

```text
┌────────────────────────────────────────────────────────────────┐
│                     開発者操作                                  │
│  git tag v1.0.0 && git push origin v1.0.0                      │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  GitHub Actions (release.yml)                                  │
│  ├─ npm ci                                                      │
│  ├─ npm run build                                               │
│  ├─ npm run sync:dogfood                                        │
│  ├─ tar -czf .cc-craft-kit.tar.gz .cc-craft-kit/                            │
│  ├─ GitHub Release 作成                                         │
│  ├─ .cc-craft-kit.tar.gz アップロード                                 │
│  └─ install.sh を GitHub Pages へデプロイ                        │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  GitHub Releases                                               │
│  - Tag: v1.0.0                                                  │
│  - Asset: .cc-craft-kit.tar.gz                                        │
│  - Changelog                                                    │
└────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌────────────────────────────────────────────────────────────────┐
│  GitHub Pages (https://takumi.dev/install.sh)                  │
│  - install.sh スクリプト                                         │
└────────────────────────────────────────────────────────────────┘
```

---

## 13. 実装タスクリスト

### Phase 1: インストールスクリプト開発

#### タスク 1: `scripts/install.sh` の作成

**担当:** インストールスクリプト本体の作成

**成果物:**
- `scripts/install.sh` ファイル
- 実行権限付与（`chmod +x`）

**受け入れ基準:**
- ファイルが作成され、シェバン `#!/bin/sh` が記述されていること
- `set -e` でエラー時に即座に終了すること

---

#### タスク 2: `check_prerequisites()` 関数の実装

**担当:** 環境チェック関数

**成果物:**
- Node.js、npm、curl、tar の存在確認
- Node.js バージョンチェック（18 以上）

**受け入れ基準:**
- Node.js 未インストール時にエラーメッセージを表示すること
- Node.js バージョンが 18 未満の場合にエラーメッセージを表示すること
- npm、curl、tar が未インストールの場合にエラーメッセージを表示すること

---

#### タスク 3: `detect_os()` 関数の実装

**担当:** OS 検出関数

**成果物:**
- `uname -s` を使用した OS 検出
- "linux"、"macos"、"windows" を返す

**受け入れ基準:**
- Linux、macOS、Windows を正しく検出すること
- 未対応 OS の場合は "unknown" を返すこと

---

#### タスク 4: `fetch_latest_version()` 関数の実装

**担当:** GitHub Releases API から最新バージョンを取得

**成果物:**
- GitHub Releases API へのリクエスト
- `tag_name` と `browser_download_url` の抽出

**受け入れ基準:**
- `$LATEST_VERSION` と `$DOWNLOAD_URL` が正しく設定されること
- API エラー時にエラーメッセージを表示すること

---

#### タスク 5: `download_archive()` 関数の実装

**担当:** アーカイブダウンロード関数

**成果物:**
- `mktemp` で一時ファイル作成
- `curl` でダウンロード

**受け入れ基準:**
- 一時ファイルパスを返すこと
- ダウンロード失敗時にエラーメッセージを表示すること

---

#### タスク 6: `extract_archive()` 関数の実装

**担当:** アーカイブ展開関数

**成果物:**
- `.cc-craft-kit/` 既存チェック
- 上書き確認プロンプト
- `tar -xzf` で展開

**受け入れ基準:**
- 既存の `.cc-craft-kit/` ディレクトリがある場合、上書き確認を表示すること
- ユーザーが "y" 以外を入力した場合、インストールをキャンセルすること
- アーカイブが正しく展開されること

---

#### タスク 7: `create_symlink()` 関数の実装

**担当:** シンボリックリンク作成関数

**成果物:**
- `.claude/commands/` ディレクトリ作成
- `ln -s` でシンボリックリンク作成

**受け入れ基準:**
- シンボリックリンクが正しく作成されること
- OS 別の処理（Windows では `cmd //c mklink` を試行）が実装されていること
- シンボリックリンク作成失敗時に警告メッセージを表示すること

---

#### タスク 8: `generate_env()` 関数の実装

**担当:** `.env` ファイル生成関数

**成果物:**
- `.env` 既存チェック
- `.cc-craft-kit/.env.example` から `.env` へコピー

**受け入れ基準:**
- `.env` がすでに存在する場合、スキップすること
- `.env.example` が存在しない場合、警告メッセージを表示すること

---

#### タスク 9: `init_project()` 関数の実装

**担当:** プロジェクト初期化関数

**成果物:**
- `npx tsx .cc-craft-kit/commands/init.ts` 実行

**受け入れ基準:**
- 初期化が成功すること
- 初期化失敗時に警告メッセージを表示し、手動実行案内を表示すること

---

#### タスク 10: `show_success()` 関数の実装

**担当:** 成功メッセージ表示関数

**成果物:**
- インストール完了メッセージ
- 次のステップ案内

**受け入れ基準:**
- 見やすいメッセージを表示すること
- `.env` 設定、`/cft:status` 実行、仕様書作成の案内を含むこと

---

#### タスク 11: 引数解析の実装

**担当:** コマンドライン引数の解析

**成果物:**
- `--project <name>`、`--version <version>`、`--help` のサポート
- パス指定（引数なしの場合はカレントディレクトリ）

**受け入れ基準:**
- 各オプションが正しく処理されること
- `--help` で使用方法を表示すること

---

#### タスク 12: エラーメッセージの日本語化

**担当:** すべてのエラーメッセージを日本語に翻訳

**成果物:**
- 日本語エラーメッセージ

**受け入れ基準:**
- すべてのエラーメッセージが日本語で表示されること

---

### Phase 2: CI/CD パイプライン構築

#### タスク 13: `.github/workflows/release.yml` の作成

**担当:** GitHub Actions ワークフロー

**成果物:**
- リリースワークフローファイル
- ビルド、アーカイブ作成、GitHub Releases へのアップロード
- GitHub Pages へのデプロイ

**受け入れ基準:**
- タグプッシュ時に自動実行されること
- `.cc-craft-kit.tar.gz` が GitHub Releases にアップロードされること
- `install.sh` が GitHub Pages にデプロイされること

---

#### タスク 14: GitHub Pages セットアップ

**担当:** リポジトリ設定

**成果物:**
- GitHub Pages の有効化
- カスタムドメイン設定（オプション）

**受け入れ基準:**
- `install.sh` が公開 URL からアクセス可能であること

---

### Phase 3: テスト

#### タスク 15: インストールスクリプトの動作テスト

**担当:** クロスプラットフォームテスト

**成果物:**
- Linux、macOS、Windows での動作確認

**受け入れ基準:**
- すべての OS でインストールが正常に完了すること
- エラーハンドリングが適切に動作すること

---

#### タスク 16: リリースフローの E2E テスト

**担当:** エンドツーエンドテスト

**成果物:**
- タグプッシュから配布までの一連の流れを検証

**受け入れ基準:**
- タグプッシュ後、GitHub Releases に成果物が自動アップロードされること
- GitHub Pages に `install.sh` がデプロイされること
- ユーザーが `curl | sh` でインストールできること
