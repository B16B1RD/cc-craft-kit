---
id: "d2566351-04f8-4ad5-a631-fc8cbb156efb"
name: "移行テスト"
phase: "completed"
branch_name: "main"
github_issue_number: null
pr_url: null
created_at: "2025-11-18T12:13:48Z"
updated_at: "2025-11-18T13:28:49Z"
---

# 移行テスト


## 1. 背景と目的

### 背景

Takumi から cc-craft-kit への移行が正常に完了したかテスト

### 目的

プロジェクト名の変更（Takumi → cc-craft-kit）および開発フローの変更（ビルドプロセス削除、TypeScript 直接実行）が正常に完了したことを確認します。
---

## 2. 対象ユーザー

- cc-craft-kit プロジェクトの開発者
- ドッグフーディング環境を使用する開発者
---

## 3. 受け入れ基準

### 必須要件

- [x] `.cc-craft-kit/` ディレクトリが `.cc-craft-kit/` に変更されている
- [x] `cc-craft-kit.db` が `cc-craft-kit.db` に変更されている
- [x] `/cft:*` スラッシュコマンドが `/cft:*` に変更されている
- [x] TypeScript ファイルが直接 `.cc-craft-kit/` にコピーされる（ビルド不要）
- [x] `npx tsx` で TypeScript ファイルが直接実行できる

### 機能要件

- [x] `npm run sync:dogfood` で `src/` から `.cc-craft-kit/` に TypeScript ファイルがコピーされる
- [x] 古い JavaScript ファイル (`.js`, `.d.ts`) が自動削除される
- [x] `npm run check:sync` で `src/` と `.cc-craft-kit/` の整合性がチェックできる
- [x] すべてのスラッシュコマンドが正常に動作する
- [x] 既存の仕様書データが正常に読み込める（33 件の仕様書が正常に表示）
- [x] 新規仕様書が正常に作成できる（GitHub Issue #34 も自動作成）
- [x] GitHub 統合が正常に動作する（Issue 作成、Project 追加が成功）

### 非機能要件

- [x] ドキュメント（`CLAUDE.md`, `docs/QUICK_START.md`）が更新されている
- [x] マイグレーションによるデータ損失がない（既存 33 件の仕様書が正常に動作）
- [ ] 開発フローの変更がチーム内に周知されている
---

## 4. 制約条件

### 開発環境

- Node.js 18.0.0 以上が必要
- `npx tsx` で TypeScript を直接実行する環境が必要
- `.cc-craft-kit/` ディレクトリは Git 管理対象外（`.gitignore` に含まれる）

### 既存データの互換性

- データベーススキーマは変更しない
- 既存の仕様書ファイルは移行前のまま `.cc-craft-kit/specs/` に配置される
---

## 5. 依存関係

### 関連仕様書

- 仕様書 #32: Takumi から cc-craft-kit への変更が不十分（名称変更）
- 仕様書 #16: 開発キットソースとドッグフーディング環境の整理と整合性チェック

### 変更されたファイル

- `src/scripts/sync-dogfood.ts` - ビルド成果物（`dist/`）から TypeScript ソース（`src/`）へ変更
- `src/scripts/check-sync.ts` - 整合性チェックの対象を変更
- `package.json` - `build:dogfood` スクリプトからビルドを削除
- `CLAUDE.md` - 開発フロー説明を更新
- `docs/QUICK_START.md` - セットアップ手順を更新
---

## 6. テスト設計

### 6.1 テスト戦略

移行テストは以下の 3 つのカテゴリに分類して実施します。

#### カテゴリ1: ファイル・ディレクトリ構造の検証

**目的**: プロジェクト名の変更がすべてのファイルとディレクトリに正しく反映されているか確認

**検証項目**:
- `.cc-craft-kit/` ディレクトリの存在確認
- `cc-craft-kit.db` ファイルの存在確認
- `.gitignore` に `.cc-craft-kit/` が含まれているか確認
- シンボリックリンク `.claude/commands/cc-craft-kit/` が正しく設定されているか確認

#### カテゴリ2: ビルドプロセス削除の検証

**目的**: TypeScript ファイルの直接実行方式が正常に機能しているか確認

**検証項目**:
- `npm run sync:dogfood` が TypeScript ファイルを `.cc-craft-kit/` にコピーするか確認
- 古い `.js`, `.d.ts` ファイルが自動削除されるか確認
- `npm run check:sync` で整合性チェックが動作するか確認
- スラッシュコマンドが `npx tsx` で TypeScript ファイルを直接実行できるか確認

#### カテゴリ3: 機能統合テスト

**目的**: 既存機能が移行後も正常に動作するか確認

**検証項目**:
- 既存の仕様書データの読み込み
- 新規仕様書の作成
- GitHub Issue の作成と同期
- フェーズ移行機能
- GitHub Projects 連携

### 6.2 テストシナリオ

#### シナリオ1: 同期スクリプトの動作確認

```bash
# 1. src/ のファイルを編集
echo "// test comment" >> src/commands/status.ts

# 2. 同期実行
npm run sync:dogfood

# 3. .cc-craft-kit/ に反映されたか確認
cat .cc-craft-kit/commands/status.ts | grep "test comment"

# 4. 整合性チェック
npm run check:sync
```

**期待結果**: 変更が `.cc-craft-kit/` に反映され、整合性チェックが成功

#### シナリオ2: スラッシュコマンドの実行確認

```bash
# 1. 仕様書一覧の表示
/cft:spec-list

# 2. 仕様書の詳細表示
/cft:spec-get d2566351

# 3. プロジェクト状態の確認
/cft:status
```

**期待結果**: すべてのコマンドが正常に実行され、エラーが発生しない

#### シナリオ3: GitHub 統合の動作確認

```bash
# 1. 新規仕様書を作成
/cft:spec-create "移行テスト2" "2回目のテスト"

# 2. GitHub Issue を作成
/cft:github-issue-create <新しい仕様書ID>

# 3. Issue が作成されたか GitHub で確認
gh issue view <Issue番号>
```

**期待結果**: GitHub Issue が自動作成され、仕様書と同期される

#### シナリオ4: データ移行の確認

```bash
# 1. 既存の仕様書一覧を表示
/cft:spec-list

# 2. 仕様書件数が 33 件以上あるか確認
/cft:spec-list | grep "Total:"

# 3. ランダムに既存の仕様書を選んで詳細表示
/cft:spec-get <既存の仕様書ID>
```

**期待結果**: すべての既存データが正常に表示される

### 6.3 テスト環境

#### 必要な環境

- Node.js 18.0.0 以上
- `npx tsx` がインストールされている
- GitHub CLI (`gh`) がインストールされている
- Git リポジトリが初期化されている
- GitHub トークンが `.env` に設定されている

#### テストデータ

- 既存の 33 件の仕様書データ
- `.cc-craft-kit/cc-craft-kit.db` データベースファイル
- GitHub Issue #33（この仕様書に対応）

### 6.4 テスト手順

#### ステップ1: 事前確認

```bash
# Node.js バージョン確認
node --version

# tsx が利用可能か確認
npx tsx --version

# データベースファイルの存在確認
ls -la .cc-craft-kit/cc-craft-kit.db
```

#### ステップ2: 同期スクリプトのテスト

```bash
# 整合性チェック
npm run check:sync

# 同期実行（Dry-run）
npm run sync:dogfood:dry

# 同期実行（本番）
npm run sync:dogfood

# 再度整合性チェック
npm run check:sync
```

#### ステップ3: スラッシュコマンドのテスト

各スラッシュコマンドを順番に実行し、エラーが発生しないか確認します。

```bash
/cft:status
/cft:spec-list
/cft:spec-get d2566351
```

#### ステップ4: GitHub 統合のテスト

```bash
# Issue が正しく作成されているか確認
gh issue view 33

# 仕様書と Issue の同期状態を確認
/cft:spec-get d2566351 | grep "GitHub Issue"
```

#### ステップ5: データ整合性の確認

```bash
# 既存の仕様書がすべて読み込めるか確認
/cft:spec-list | grep "Total:"

# ランダムに 5 件の仕様書を詳細表示してエラーがないか確認
```

### 6.5 合格基準

以下のすべての条件を満たす場合、移行テストは合格とします。

- ✅ `npm run check:sync` がエラーなく完了する
- ✅ すべてのスラッシュコマンドが正常に実行できる
- ✅ 既存の 33 件の仕様書データがすべて正常に表示される
- ✅ 新規仕様書の作成と GitHub Issue の自動作成が正常に動作する
- ✅ GitHub 統合（Issue 作成、Project 追加）が正常に動作する
- ✅ TypeScript ファイルが `.cc-craft-kit/` に正しくコピーされる
- ✅ 古い `.js`, `.d.ts` ファイルが自動削除される
- ✅ ドキュメントが最新の状態に更新されている

### 6.6 テスト結果記録

#### 実施日時

2025/11/18

#### テスト結果

| カテゴリ | テスト項目 | 結果 | 備考 |
|---|---|---|---|
| ファイル構造 | `.cc-craft-kit/` ディレクトリの存在 | ✅ 合格 | 正常に存在 |
| ファイル構造 | `cc-craft-kit.db` ファイルの存在 | ✅ 合格 | 正常に存在 |
| ファイル構造 | `.gitignore` の設定 | ✅ 合格 | 正常に設定 |
| ファイル構造 | シンボリックリンクの設定 | ✅ 合格 | 正常に設定 |
| ビルドプロセス | `npm run sync:dogfood` | ✅ 合格 | TypeScript ファイルが正しくコピーされる |
| ビルドプロセス | 古いファイルの自動削除 | ✅ 合格 | `.js`, `.d.ts` が自動削除される |
| ビルドプロセス | `npm run check:sync` | ✅ 合格 | 整合性チェックが正常に動作 |
| ビルドプロセス | `npx tsx` による直接実行 | ✅ 合格 | すべてのコマンドが正常に実行 |
| 機能統合 | 既存データの読み込み | ✅ 合格 | 33 件の仕様書が正常に表示 |
| 機能統合 | 新規仕様書の作成 | ✅ 合格 | Issue #34 が自動作成された |
| 機能統合 | GitHub 統合 | ✅ 合格 | Issue 作成、Project 追加が成功 |
| 機能統合 | フェーズ移行 | ✅ 合格 | フェーズ変更が正常に動作 |

#### 総合評価

**✅ 合格**

すべてのテスト項目が合格基準を満たしています。Takumi から cc-craft-kit への移行は正常に完了しました。
---

## 7. 参考情報

### テスト実施時の環境

- Node.js バージョン: 18.0.0+
- OS: Linux (WSL2)
- Git バージョン: 2.34.1+
- GitHub CLI バージョン: 2.40.0+

### 変更の背景

開発中は TypeScript ファイルを直接 `npx tsx` で実行するため、ビルドプロセスが不要になりました。`dist/` ディレクトリは npm パッケージ配布用にのみ使用します。

### 関連ドキュメント

- `CLAUDE.md` - プロジェクト全体の開発ガイド
- `docs/QUICK_START.md` - クイックスタートガイド
- `docs/ARCHITECTURE.md` - アーキテクチャ設計ドキュメント
---

## 8. 実装タスクリスト

この仕様書の受け入れ基準のほとんどは既に達成されています。残っているタスクは以下の通りです。

### タスク1: チーム内周知ドキュメントの作成

**優先度**: High
**依存関係**: なし
**見積もり**: 30 分

**内容**:
- 移行内容をまとめた周知ドキュメントを作成
- 主な変更点（プロジェクト名、スラッシュコマンド名、ビルドプロセス削除）を明記
- 開発者が知るべき新しいワークフローを説明

**対象ファイル**:
- `docs/MIGRATION_GUIDE.md`（新規作成）

**受け入れ基準**:
- [ ] 周知ドキュメントが作成されている
- [ ] 移行の背景と目的が明確に記載されている
- [ ] 開発者が従うべき新しいワークフローが説明されている
- [ ] よくある質問 (FAQ) セクションがある
---

### タスク2: CHANGELOG.md への変更履歴記録

**優先度**: High
**依存関係**: なし
**見積もり**: 15 分

**内容**:
- `CHANGELOG.md` に今回の移行に関する変更履歴を記録
- バージョン番号と日付を明記
- 破壊的変更 (Breaking Changes) を強調

**対象ファイル**:
- `CHANGELOG.md`

**受け入れ基準**:
- [ ] CHANGELOG.md に移行の変更履歴が記録されている
- [ ] バージョン番号と日付が正しく記載されている
- [ ] Breaking Changes セクションが明記されている
---

### タスク3: スラッシュコマンドのドキュメント修正

**優先度**: Medium
**依存関係**: なし
**見積もり**: 20 分

**内容**:
- 仕様書内のスラッシュコマンド例を `/cft:*` から `/cft:*` に修正
- ドキュメント全体で一貫性を保つ

**対象ファイル**:
- `.cc-craft-kit/specs/d2566351-04f8-4ad5-a631-fc8cbb156efb.md`（この仕様書）
- その他のドキュメント（必要に応じて）

**受け入れ基準**:
- [ ] すべてのスラッシュコマンド例が `/cft:*` 形式に修正されている
- [ ] ドキュメント内の一貫性が保たれている
---

### タスク4: 移行完了の総合テスト実行

**優先度**: High
**依存関係**: タスク 1, タスク 2, タスク 3
**見積もり**: 30 分

**内容**:
- 「6.2 テストシナリオ」に記載された全テストケースを実行
- テスト結果を記録し、合格基準を満たしているか確認
- 問題があれば修正して再テスト

**テストシナリオ**:
1. 同期スクリプトの動作確認
2. スラッシュコマンドの実行確認
3. GitHub 統合の動作確認
4. データ移行の確認

**受け入れ基準**:
- [ ] すべてのテストシナリオが実行されている
- [ ] テスト結果が「6.6 テスト結果記録」に記録されている
- [ ] すべての合格基準を満たしている
- [ ] 問題が発見された場合は修正されている
---

### 実装順序

1. **タスク3**: スラッシュコマンドのドキュメント修正（最優先）
2. **タスク2**: CHANGELOG.md への変更履歴記録
3. **タスク1**: チーム内周知ドキュメントの作成
4. **タスク4**: 移行完了の総合テスト実行（最終確認）
---

### 完了条件

以下のすべてが満たされた場合、このタスクリストは完了とします。

- ✅ すべてのタスクが完了している
- ✅ テスト結果が合格基準を満たしている
- ✅ チーム内に移行内容が周知されている
- ✅ ドキュメントが最新の状態に更新されている
