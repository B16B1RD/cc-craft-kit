# /cft:spec-phase <id> implementation で、実装が自動実行されない

**仕様書 ID:** c9d14482-9af2-443f-8d12-c55110b9f5c0
**フェーズ:** design
**作成日時:** 2025/11/28 12:00:00
**更新日時:** 2025/11/28 13:15:00

---

## 1. 背景と目的

### 背景

現在の `/cft:spec-phase <id> implementation` コマンドは、フェーズの切り替えとガイダンスメッセージの表示のみを行い、実装開始はユーザーが指示しないと始まらない。

具体的な問題:
- `spec-phase.md` では「自動実行フロー」と記述されているが、実際の実装（`phase-automation.ts` の `handleImplementationPhase()`）ではタスク一覧の表示のみ
- タスク粒度バリデーション、TodoWrite によるタスク進捗管理、型チェック・リント実行が未実装
- ユーザーは手動で実装を開始する必要があり、開発フローが中断される

### 目的

implementation フェーズに移行した際に、実装作業を自動で開始し、開発者の手間を削減する。フェーズ移行→タスク読み込み→実装開始までをシームレスに連携させる。

---

## 2. 対象ユーザー

cc-craft-kit を使用して仕様駆動開発（SDD）を行う開発者

---

## 3. 受け入れ基準

### 必須要件

- [ ] `/cft:spec-phase <id> implementation` 実行後、ユーザーの追加指示なしに実装が自動開始される
- [ ] 仕様書の「実装タスクリスト」セクションからタスクを読み込み、TodoWrite で進捗管理を開始する

### 機能要件

- [ ] タスク粒度バリデーションを実行し、粗すぎるタスクがある場合は分割を提案する
- [ ] 型チェック（typescript-eslint スキル）を自動実行し、エラーがあれば表示する
- [ ] 最初のタスクから順に実装を開始する（タスクを in_progress に設定）
- [ ] 実装対象ファイルの特定と、設計詳細セクションの確認を自動で行う

### 非機能要件

- [ ] プロンプトファースト原則に従い、可能な限りプロンプト層（.md）で実装する
- [ ] 自動実行中もユーザーが中断・制御できるようにする

---

## 4. 制約条件

- プロンプトファースト原則: Claude Code のツール（Read/Write/Edit/Task/Skill/TodoWrite）で実現可能な処理はプロンプト層で実装する
- 既存の EventBus アーキテクチャとの整合性を維持する
- `spec-phase.md` の自動実行フロー定義に従う

---

## 5. 依存関係

- `src/slash-commands/spec-phase.md` - スラッシュコマンド定義
- `src/core/workflow/phase-automation.ts` - フェーズ自動処理ハンドラー
- `src/commands/spec/update-phase.ts` - フェーズ更新 CLI スクリプト
- `typescript-eslint` スキル - 型チェック・リント実行

---

## 6. 参考情報

- `CLAUDE.md` - プロンプトファースト原則、設計・実装方法の選択ガイド
- `src/slash-commands/spec-create.md` - 自動実行フローの参考実装
- `src/slash-commands/spec-phase.md` の Step 8 - implementation フェーズの自動処理定義
