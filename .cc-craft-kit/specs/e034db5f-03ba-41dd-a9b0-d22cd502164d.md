# GitHub Issue の運用見直し

**仕様書 ID:** e034db5f-03ba-41dd-a9b0-d22cd502164d
**フェーズ:** requirements
**作成日時:** 2025-01-25 10:30
**更新日時:** 2025-01-25 10:30

---

## 1. 背景と目的

### 背景

現在の cc-craft-kit では、GitHub Issue と仕様書の連携において以下の課題がある:

- **Issue 本文の更新タイミングが限定的**: 仕様書更新時に Issue 本文が更新されるが、テンプレート状態からの更新のみが対象となっており、一度編集された Issue 本文は再同期されない場合がある
- **チェックリスト同期機能が未実装**: 仕様書内の受け入れ基準（チェックボックス形式）と GitHub Issue のチェックボックスが連動しておらず、手動での二重管理が必要
- **変更履歴の記録が不十分**: 仕様書更新時のコメントは「更新されました」という通知のみで、何が変更されたかの要約がない

### 目的

GitHub Issue を「仕様書の可視化ビュー」として位置づけ、以下を実現する:

- Issue 本文を常に最新の仕様書内容で同期（Source of Truth は仕様書ファイル）
- 受け入れ基準のチェックボックス状態を双方向同期
- 仕様書の変更履歴をコメントで要約付きで記録

---

## 2. 対象ユーザー

- cc-craft-kit を使用して仕様駆動開発を行う開発者
- GitHub Issue で進捗を確認するプロジェクト管理者

---

## 3. 受け入れ基準

### 必須要件

- [ ] Issue 本文が仕様書の内容と常に同期されること
- [ ] 仕様書ファイルが Source of Truth として機能すること
- [ ] 受け入れ基準のチェックボックスが双方向同期されること

### 機能要件

- [ ] 仕様書更新時に Issue 本文を自動更新する機能
- [ ] チェックボックス状態の仕様書 → Issue 同期機能
- [ ] チェックボックス状態の Issue → 仕様書 同期機能
- [ ] 変更履歴をコメントで記録する機能（変更要約付き）
- [ ] 同期競合時の解決ポリシーの実装

### 非機能要件

- [ ] GitHub API レート制限を考慮した設計
- [ ] 同期処理のエラーハンドリングとリトライ機構
- [ ] 同期状態の可視化（最終同期日時、同期ステータス）

---

## 4. 制約条件

- 既存の cc-craft-kit アーキテクチャに準拠すること
- GitHub API v3/v4 の仕様に準拠すること
- プロンプトファースト原則に従い、可能な限りプロンプトベースで実装すること

---

## 5. 依存関係

- `src/integrations/github/` - 既存の GitHub 連携モジュール
- `src/core/workflow/event-bus.ts` - イベント駆動アーキテクチャ
- `src/core/sync/` - 同期サービス

---

## 6. 参考情報

- GitHub API ドキュメント: https://docs.github.com/en/rest
- 既存の Issue 同期実装: `src/integrations/github/sync.ts`
