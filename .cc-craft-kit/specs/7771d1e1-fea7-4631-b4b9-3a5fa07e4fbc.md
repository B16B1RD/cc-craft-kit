# インストーラーでエラー

**仕様書 ID:** 7771d1e1-fea7-4631-b4b9-3a5fa07e4fbc
**フェーズ:** requirements
**作成日時:** 2025/12/04 12:00:00
**更新日時:** 2025/12/04 12:00:00

---

## 1. 背景と目的

### 背景

インストーラーで以下のエラーが発生する。
$ curl -fsSL https://raw.githubusercontent.com/B16B1RD/cc-craft-kit/main/scripts/install.sh | sh
cc-craft-kit のインストールを開始します...

環境をチェックしています...
✓ 環境チェック完了
GitHub Releases から最新バージョンを取得しています...
✓ 最新バージョン: v0.1.6
エラー: 無効なアーカイブです。.cc-craft-kit/ ディレクトリが見つかりません。

### 目的

リリースワークフローで生成されるアーカイブの構造を修正し、インストールスクリプトが正常に動作するようにする。

---

## 2. 対象ユーザー

cc-craft-kit を新規インストールするユーザー

---

## 3. 受け入れ基準

### 必須要件

- [ ] `curl -fsSL ... | sh` でインストールが正常に完了すること
- [ ] リリースアーカイブに `.cc-craft-kit/` ディレクトリが正しく含まれること

### 機能要件

- [ ] `.github/workflows/release.yml` のアーカイブ生成ロジックを修正する
- [ ] `scripts/install.sh` の検証ロジックを堅牢化する（オプション）

### 非機能要件

- [ ] 既存の v0.1.6 ユーザーへの影響を最小化する
- [ ] CI/CD パイプラインの変更を最小限に抑える

---

## 4. 制約条件

- リリースワークフローは GitHub Actions で実行される
- `tar` コマンドのアーカイブ構造に依存した設計
- install.sh は `^\.cc-craft-kit/` パターンでアーカイブを検証している

---

## 5. 依存関係

- `.github/workflows/release.yml` - リリースワークフロー
- `scripts/install.sh` - インストールスクリプト
- `src/scripts/sync-dogfood.ts` - ソース同期スクリプト

---

## 6. 参考情報

- 根本原因: `tar -czf ../.cc-craft-kit.tar.gz .` がディレクトリ内から実行されるため、アーカイブ内に `.cc-craft-kit/` プレフィックスが含まれない
- 修正案: `tar -czf .cc-craft-kit.tar.gz .cc-craft-kit/` を親ディレクトリから実行する
