# スキル実装の改善

**仕様書 ID:** 45a7f0d7-1956-4df0-882b-ce463e06ab96
**フェーズ:** implementation
**作成日時:** 2025/12/05 15:30:00
**更新日時:** 2025/12/05 19:00:00

---

## 1. 背景と目的

### 背景

cc-craft-kit には 4 つのスキル（pr-creator, database-schema-validator, git-operations, typescript-eslint）が実装されている。レビューの結果、これらのスキルは高品質だが、cc-craft-kit 固有の情報（プロジェクト固有の設定、ブランチ戦略、関連コマンド等）が不足していることが判明した。

現状の課題:
- 各スキルは汎用的な説明のみで、cc-craft-kit 固有のコンテキストがない
- プロジェクト固有のコマンド（`npm run typecheck`, `npm run lint` 等）への参照がない
- cc-craft-kit のブランチ戦略（GitHub Flow + develop）との連携説明がない
- 他スキル/サブエージェントとの連携情報がない

### 目的

各スキルに cc-craft-kit 固有のセクションを追加し、プロジェクト内での利用価値を向上させる。

---

## 2. 対象ユーザー

- cc-craft-kit を使用する開発者
- cc-craft-kit のスキルを活用して開発効率を上げたいユーザー
- 新規にスキルを作成する際の参考を求めるユーザー

---

## 3. 受け入れ基準

### 必須要件

- [ ] pr-creator に「ドラフト PR を Ready に変更」手順を追加
- [ ] database-schema-validator に cc-craft-kit 固有のスキーマファイル参照を追加
- [ ] git-operations に cc-craft-kit ブランチ戦略セクションを追加
- [ ] typescript-eslint に cc-craft-kit 固有の設定参照を追加

### 機能要件

- [ ] 各スキルに「cc-craft-kit での使用」セクションを追加
- [ ] 各スキルに「関連スキル/サブエージェント」セクションを追加
- [ ] 各スキルに本プロジェクト固有のコマンド例を追加

### 非機能要件

- [ ] 既存のスキル構造を破壊しない（追記のみ）
- [ ] 同期後も正常に動作する（`npm run sync:dogfood`）
- [ ] セクション構成の一貫性を維持

---

## 4. 制約条件

- スキルファイルは `src/skills/*/SKILL.md` に配置（マスターソース）
- 編集後は `npm run sync:dogfood` で `.claude/skills/` に同期が必要
- YAML フロントマター形式を維持
- 既存セクションの削除は行わない（追記のみ）

---

## 5. 依存関係

### 対象ファイル

- `src/skills/pr-creator/SKILL.md`
- `src/skills/database-schema-validator/SKILL.md`
- `src/skills/git-operations/SKILL.md`
- `src/skills/typescript-eslint/SKILL.md`

### 関連ドキュメント

- `docs/SUBAGENTS_AND_SKILLS_GUIDE.md` - スキル作成ガイド
- `CLAUDE.md` - プロジェクト開発方針

---

## 6. 参考情報

- レビューレポート: `/home/autum/.claude/plans/polymorphic-floating-tower.md`
- Claude Code 公式スキル仕様: https://docs.anthropic.com/en/docs/claude-code/skills

---

## 7. 設計詳細

### 7.1 アーキテクチャ設計

#### 全体構成

各スキルファイル（`src/skills/*/SKILL.md`）に以下の統一セクションを追加する:

```
既存セクション
├── YAML フロントマター（name, description）
├── # タイトル
├── ## Capabilities / 機能概要
├── ## Usage Examples
├── ## Best Practices
├── ## Output Format
└── [スキル固有セクション]

追加セクション（末尾に追記）
├── ## cc-craft-kit との統合
│   ├── 起動方式
│   ├── プロジェクト固有設定
│   └── 関連コマンド
└── ## 関連スキルとサブエージェント
    ├── 関連スキル一覧（テーブル形式）
    └── 関連サブエージェント一覧（テーブル形式）
```

#### 設計方針

1. **追記のみの方針**: 既存セクションは変更せず、末尾に新セクションを追加
2. **統一フォーマット**: 4 スキルすべてに同じセクション構成を適用
3. **日本語/英語の併用**: pr-creator は日本語、他は英語を維持
4. **テーブル形式の活用**: 関連スキル/サブエージェントはテーブルで整理

### 7.2 実装方針

#### 修正対象ファイル

| ファイル | 変更内容 |
|---------|---------|
| `src/skills/pr-creator/SKILL.md` | ドラフト PR 変更手順 + cc-craft-kit 統合セクション + 関連スキル/サブエージェント |
| `src/skills/database-schema-validator/SKILL.md` | cc-craft-kit 固有スキーマ参照 + cc-craft-kit 統合セクション + 関連スキル/サブエージェント |
| `src/skills/git-operations/SKILL.md` | ブランチ戦略セクション + cc-craft-kit 統合セクション + 関連スキル/サブエージェント |
| `src/skills/typescript-eslint/SKILL.md` | cc-craft-kit 固有設定参照 + cc-craft-kit 統合セクション + 関連スキル/サブエージェント |

#### 各スキルの追加内容詳細

**pr-creator**:
- ドラフト PR を Ready に変更する手順（`gh pr ready` コマンド）
- 仕様書との連携フロー説明
- 関連: git-operations, typescript-eslint, code-reviewer

**database-schema-validator**:
- 検証対象: `src/core/schema.ts`（Kysely スキーマ定義）
- マイグレーション: `.cc-craft-kit/core/migrations/`
- 関連: typescript-eslint, git-operations

**git-operations**:
- cc-craft-kit ブランチ戦略（GitHub Flow + develop）
- ブランチ命名規則（feature/, fix/, hotfix/ 等）
- Conventional Commits への準拠
- 関連: pr-creator

**typescript-eslint**:
- 設定ファイル: `tsconfig.json`, `eslint.config.mjs`
- 実行コマンド: `npm run typecheck`, `npm run lint`
- 関連: database-schema-validator, code-reviewer, refactoring-assistant

### 7.3 機能マッピング

| 機能 | 対象スキル | 追加セクション | 実装場所 |
|-----|----------|--------------|---------|
| ドラフト PR 変更手順 | pr-creator | 新規セクション | 実装フロー後 |
| スキーマファイル参照 | database-schema-validator | cc-craft-kit との統合 | 末尾 |
| ブランチ戦略 | git-operations | cc-craft-kit との統合 | 末尾 |
| 設定ファイル参照 | typescript-eslint | cc-craft-kit との統合 | 末尾 |
| 関連スキル一覧 | 全スキル | 関連スキルとサブエージェント | 末尾 |

### 7.4 テスト戦略

| テスト対象 | テスト内容 | 検証方法 |
|----------|----------|---------|
| YAML フロントマター | 形式が維持されていること | `npm run sync:dogfood` 実行後のエラー確認 |
| セクション構造 | 既存セクションが破壊されていないこと | 目視確認 + diff |
| 同期動作 | `.claude/skills/` に正常同期されること | `npm run sync:dogfood` 実行 |
| スキル認識 | Claude Code がスキルを認識すること | Skill ツールでの起動確認 |

### 7.5 移行計画

#### Phase 1: pr-creator の改善
1. ドラフト PR 変更手順を追加
2. cc-craft-kit 統合セクションを追加
3. 関連スキル/サブエージェントセクションを追加

#### Phase 2: database-schema-validator の改善
1. cc-craft-kit 固有スキーマ参照を追加
2. cc-craft-kit 統合セクションを追加
3. 関連スキル/サブエージェントセクションを追加

#### Phase 3: git-operations の改善
1. cc-craft-kit ブランチ戦略セクションを追加
2. cc-craft-kit 統合セクションを追加
3. 関連スキル/サブエージェントセクションを追加

#### Phase 4: typescript-eslint の改善
1. cc-craft-kit 固有設定参照を追加
2. cc-craft-kit 統合セクションを追加
3. 関連スキル/サブエージェントセクションを追加

#### Phase 5: 検証と同期
1. `npm run sync:dogfood` で同期
2. 各スキルの動作確認
3. セクション構成の一貫性確認

---

## 8. 実装タスクリスト

### Phase 1: pr-creator の改善

- [x] pr-creator にドラフト PR を Ready に変更する手順を追加 (#805)
- [x] pr-creator に cc-craft-kit 統合セクションを追加 (#806)
- [x] pr-creator に関連スキル/サブエージェントセクションを追加 (#807)

### Phase 2: database-schema-validator の改善

- [x] database-schema-validator に cc-craft-kit 固有スキーマ参照を追加 (#808)
- [x] database-schema-validator に cc-craft-kit 統合セクションを追加 (#809)
- [x] database-schema-validator に関連スキル/サブエージェントセクションを追加 (#810)

### Phase 3: git-operations の改善

- [x] git-operations に cc-craft-kit ブランチ戦略セクションを追加 (#811)
- [x] git-operations に cc-craft-kit 統合セクションを追加 (#812)
- [x] git-operations に関連スキル/サブエージェントセクションを追加 (#813)

### Phase 4: typescript-eslint の改善

- [ ] typescript-eslint に cc-craft-kit 固有設定参照を追加 (#814)
- [ ] typescript-eslint に cc-craft-kit 統合セクションを追加 (#815)
- [ ] typescript-eslint に関連スキル/サブエージェントセクションを追加 (#816)

### Phase 5: 検証と同期

- [ ] npm run sync:dogfood で同期実行 (#817)
- [ ] 各スキルの動作確認 (#818)
- [ ] セクション構成の一貫性を最終確認 (#819)
