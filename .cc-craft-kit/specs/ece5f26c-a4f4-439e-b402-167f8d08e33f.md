# GitHub Issue 本文・変更履歴コメントの同期が機能しない

**仕様書 ID:** ece5f26c-a4f4-439e-b402-167f8d08e33f
**フェーズ:** requirements
**作成日時:** 2025/11/25 16:30:00
**更新日時:** 2025/11/25 16:30:00

---

## 1. 背景と目的

### 背景

spec.phase_changed イベント時に Issue 本文が更新されず、変更履歴コメントも追加されない問題を修正する。

GitHub Issue #368 で設計された以下の機能が実際には動作していない:

1. **Issue 本文の同期**: フェーズ変更時に Issue 本文が仕様書ファイルで更新されない
2. **変更履歴コメント（`📝 仕様書更新`）**: `spec.updated` イベントによる変更履歴コメントが追加されない

### 目的

- Issue 本文を常に最新の仕様書内容で同期する
- フェーズ変更時にも変更履歴コメントを追加する

---

## 2. 対象ユーザー

- cc-craft-kit を使用して仕様駆動開発を行う開発者
- GitHub Issue で進捗を確認するプロジェクト管理者

---

## 3. 受け入れ基準

### 必須要件

- [ ] フェーズ変更時に Issue 本文が仕様書ファイルの内容で更新される
- [ ] フェーズ変更時に変更履歴コメントが追加される

### 機能要件

- [ ] `spec.phase_changed` ハンドラーで仕様書ファイルを正しく読み込む
- [ ] `spec.phase_changed` ハンドラーで Issue 本文を更新する
- [ ] `spec.phase_changed` ハンドラーで変更履歴コメント（📝 仕様書更新）を追加する

### 非機能要件

- [ ] デバッグログを追加して問題の原因を特定できる
- [ ] エラーハンドリングを強化して失敗時に適切なメッセージを表示する

---

## 4. 制約条件

- プロンプトファースト原則に従い、可能な限りプロンプトベースで実装すること
- 既存の cc-craft-kit アーキテクチャに準拠すること
- GitHub API v3/v4 の仕様に準拠すること

---

## 5. 依存関係

- `src/core/workflow/github-integration.ts` - GitHub 統合のイベントハンドラー
- `src/integrations/github/changelog-writer.ts` - 変更履歴コメント生成
- `src/integrations/github/issues.ts` - GitHub Issues API ラッパー

---

## 6. 参考情報

- GitHub Issue #368: GitHub Issue の運用見直し
- 計画ファイル: `/home/autum/.claude/plans/lexical-scribbling-wolf.md`
