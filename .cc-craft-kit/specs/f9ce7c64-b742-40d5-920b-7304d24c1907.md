# /cft:init my-project の引数（my-project）は不要では？

**仕様書 ID:** f9ce7c64-b742-40d5-920b-7304d24c1907
**フェーズ:** completed
**作成日時:** 2025/11/29 21:45:00
**更新日時:** 2025/11/29 22:17:00

---

## 1. 背景と目的

### 背景

現在の `/cft:init` コマンドは `<project-name>` 引数を受け取るが、実装を調査した結果、以下の事実が判明した:

1. **関数シグネチャが既にオプショナル**: `initProject(projectName?: string)`
2. **デフォルト値が設定済み**: `'cc-craft-kit-project'`
3. **引数の用途は UI 表示のみ**: `config.project.name` は `/cft:status` で表示されるだけで、機能的な役割を持たない
4. **引数なしで既に動作する**: 実装上は引数を省略しても正常に初期化できる

つまり、ユーザーに引数入力を求めているが、その引数は本質的に不要である。

### 目的

- `/cft:init` コマンドの使いやすさを向上させる
- 不要な引数を削除し、コマンドをシンプルにする
- ドキュメントと実装の整合性を確保する

---

## 2. 対象ユーザー

cc-craft-kit を使用する開発者（初めて cc-craft-kit をセットアップする場合）

---

## 3. 受け入れ基準

### 必須要件

- [ ] `/cft:init` が引数なしで正常に動作すること
- [ ] スラッシュコマンド定義（`src/slash-commands/init.md`）から `argument-hint` を削除すること

### 機能要件

- [ ] `src/commands/init.ts` の関数シグネチャから引数を削除（またはそのまま維持しデフォルト値を使用）
- [ ] エラーメッセージの `/cft:init <project-name>` を `/cft:init` に変更
- [ ] README.md の使用例から引数を削除
- [ ] docs/QUICK_START.md の使用例から引数を削除

### 非機能要件

- [ ] 既存の統合テストが引数なしでもパスすること
- [ ] 後方互換性: 引数を指定した場合も従来通り動作すること（オプショナル引数として残す）

---

## 4. 制約条件

- デフォルト値 `'cc-craft-kit-project'` は複数プロジェクトで同じ名前になる可能性があるが、`/cft:status` での表示用途のみのため許容する
- GitHub 連携には `config.json` の `github.owner` と `github.repo` を使用するため、`project.name` の削除は影響しない

---

## 5. 依存関係

### 影響を受けるファイル

| ファイル | 変更内容 |
|---|---|
| `src/slash-commands/init.md` | `argument-hint` を削除 |
| `src/commands/init.ts` | 変更不要（既にオプショナル実装） |
| `src/commands/utils/error-handler.ts` | エラーメッセージを更新 |
| `README.md` | 使用例を更新 |
| `docs/QUICK_START.md` | 使用例を更新 |
| `tests/integration/commands-cli.integration.ts` | テストを引数なしで呼び出すよう更新 |

---

## 6. 参考情報

- 関連ファイル: `src/commands/init.ts:31-46`（現在のオプショナル実装）
- 関連ファイル: `src/slash-commands/init.md`（コマンド定義）
- 関連ファイル: `src/commands/utils/error-handler.ts:171`（エラーメッセージ）

---

## 7. 設計詳細

### 7.1 アーキテクチャ設計

#### 全体構成

```
ユーザー入力
    │
    ▼
┌─────────────────────────────────────┐
│ src/slash-commands/init.md          │ ← argument-hint を削除
│ (スラッシュコマンド定義)             │
└─────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────┐
│ src/commands/init.ts                │ ← 変更不要（既にオプショナル）
│ initProject(projectName?: string)   │
│   └─ デフォルト値: 'cc-craft-kit-project'
└─────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────┐
│ .cc-craft-kit/config.json           │ ← project.name に保存
│ (プロジェクト設定ファイル)           │
└─────────────────────────────────────┘
```

#### 設計方針

- **最小限の変更**: 実装（`init.ts`）は既にオプショナル引数で設計されているため、変更不要
- **ドキュメント整合性**: `argument-hint` と使用例を削除し、実装と一致させる
- **後方互換性維持**: 引数を指定した場合も従来通り動作（オプショナル引数として残す）

#### 処理フロー詳細

```
/cft:init 実行
    │
    ├─ 引数あり → projectName に設定
    │
    └─ 引数なし → デフォルト値 'cc-craft-kit-project' を使用
           │
           ▼
    config.json に project.name として保存
           │
           ▼
    /cft:status で表示（UI用途のみ）
```

### 7.2 実装方針

#### 修正対象ファイル

| ファイル | 変更内容 | 優先度 |
|---------|---------|--------|
| `src/slash-commands/init.md` | `argument-hint` 行を削除、引数説明を更新 | 必須 |
| `src/commands/utils/error-handler.ts` | エラーメッセージを `/cft:init` に変更 | 必須 |
| `README.md` | 使用例 `/cft:init my-project` → `/cft:init` | 必須 |
| `docs/QUICK_START.md` | 使用例を更新 | 必須 |
| `tests/integration/commands-cli.integration.ts` | 引数なしでテスト実行 | 推奨 |
| `src/commands/init.ts` | 変更不要 | - |

#### 各ファイルの具体的変更

**1. src/slash-commands/init.md**
```diff
 ---
 description: "cc-craft-kitプロジェクトを初期化します"
-argument-hint: "<project-name> [description]"
 ---
```

**2. src/commands/utils/error-handler.ts（行171付近）**
```diff
 export function createProjectNotInitializedError(): CLIError {
   return new CLIError(
     'Project is not initialized',
     ERROR_CODES.PROJECT_NOT_INITIALIZED,
-    'Run "/cft:init <project-name>" to initialize a new project.',
+    'Run "/cft:init" to initialize a new project.',
     {}
   );
 }
```

**3. README.md**
```diff
-/cft:init my-project
+/cft:init
```

**4. docs/QUICK_START.md**
```diff
-/cft:init my-awesome-app "My awesome project description"
+/cft:init
```

### 7.3 機能マッピング

| 機能 | 現在の実装 | 新しい実装 | 実装場所 |
|-----|----------|----------|---------|
| 引数表示 | `<project-name> [description]` | なし（引数なし） | `init.md` |
| プロジェクト名決定 | 引数 or デフォルト値 | 変更なし | `init.ts` |
| エラーメッセージ | `/cft:init <project-name>` | `/cft:init` | `error-handler.ts` |
| ドキュメント例 | `/cft:init my-project` | `/cft:init` | `README.md`, `QUICK_START.md` |

### 7.4 テスト戦略

| テスト対象 | テスト内容 | 検証方法 |
|----------|----------|---------|
| 引数なし実行 | `/cft:init` で正常初期化 | 統合テスト（引数なしで実行） |
| デフォルト値 | `config.json` に `'cc-craft-kit-project'` 保存 | config ファイル確認 |
| 後方互換性 | `/cft:init my-project` で従来通り動作 | 統合テスト（引数ありで実行） |
| エラーメッセージ | 未初期化エラーに正しいメッセージ | ユニットテスト |

### 7.5 移行計画

#### Phase 1: ドキュメント更新

1. `src/slash-commands/init.md` から `argument-hint` を削除
2. `src/commands/utils/error-handler.ts` のエラーメッセージを更新
3. `README.md` の使用例を更新
4. `docs/QUICK_START.md` の使用例を更新

#### Phase 2: テスト更新

1. `tests/integration/commands-cli.integration.ts` を引数なしでテスト
2. 後方互換性テスト（引数ありでも動作確認）

#### Phase 3: 同期・検証

1. `npm run sync:dogfood` で同期
2. `npm run typecheck` で型チェック
3. `npm test` で全テスト実行

---

## 8. 実装タスクリスト

### Phase 1: ドキュメント更新

- [x] `src/slash-commands/init.md` から `argument-hint` 行を削除
- [x] `src/commands/utils/error-handler.ts` のエラーメッセージを `/cft:init` に変更
- [x] `README.md` の使用例を `/cft:init` に更新
- [x] `docs/QUICK_START.md` の使用例を `/cft:init` に更新

### Phase 2: テスト更新

- [x] `tests/integration/commands-cli.integration.ts` を引数なしでテスト実行するよう更新

### Phase 3: 同期・検証

- [x] `npm run sync:dogfood` で同期実行
- [x] `npm run typecheck` で型チェック実行
- [x] `npm test` で全テスト実行

---

## Pull Request

- https://github.com/B16B1RD/cc-craft-kit/pull/418
