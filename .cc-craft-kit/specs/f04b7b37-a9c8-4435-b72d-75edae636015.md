# /cft:spec-create 時に自動で要求仕様書を完成させること

**仕様書 ID:** f04b7b37-a9c8-4435-b72d-75edae636015
**フェーズ:** completed
**作成日時:** 2025/11/22 22:36:52
**更新日時:** 2025/11/22 23:22:33

---

## 1. 背景と目的

### 背景

現状、仕様書の側だけの作成にとどまっているので、自動で仕様書を完成させてほしい。不明な点があればユーザーに問い合わせて情報を補完して完成させること。

### 目的

`/cft:spec-create` コマンド実行時に、仕様書のテンプレートを作成するだけでなく、以下を自動的に完成させる。これにより開発者の負担を軽減し、仕様書の品質を向上させる。

- 背景と目的の自動生成
- 対象ユーザーの推論
- 受け入れ基準の提案
- 制約条件の提示
- 依存関係の抽出

不明な情報がある場合は `AskUserQuestion` ツールで対話的に確認し、必要な情報を補完する。

---

## 2. 対象ユーザー

cc-craft-kit を使用して仕様駆動開発を行う開発者。

---

## 3. 受け入れ基準

### 必須要件

- [ ] `/cft:spec-create <name> [description]` 実行時に、テンプレートではなく完成した要求仕様書が作成される
- [ ] 不明な情報がある場合、`AskUserQuestion` ツールで対話的に確認できる
- [ ] 作成後のフェーズは `requirements` のまま（フェーズ移行しない）

### 機能要件

- [ ] 背景と目的のセクションを自動生成する
- [ ] 対象ユーザーを推論または質問で確認する
- [ ] 受け入れ基準（必須要件・機能要件・非機能要件）を提案する
- [ ] 制約条件をコードベースから推論して提示する
- [ ] 依存関係を既存の仕様書・モジュールから抽出する
- [ ] ユーザーの入力（name, description）から必要な情報を補完する

### 非機能要件

- [ ] 仕様書の作成時間を大幅に短縮する（テンプレート入力の手間を削減）
- [ ] 生成された仕様書は編集可能（完全自動ではなく、叩き台として提供）
- [ ] 既存の `/cft:spec-create` の引数仕様を変更しない（後方互換性）

---

## 4. 制約条件

- 既存の `/cft:spec-create` コマンドの引数仕様を変更しない（`<name> [description]` のまま）
- `src/commands/spec/create.ts` のロジックを拡張する形で実装する
- Task ツールや Explore サブエージェントを活用して、コードベースを解析する
- `AskUserQuestion` ツールを使用して、不明な情報を対話的に確認する
- 生成された仕様書は requirements フェーズのまま（自動でフェーズ移行しない）

---

## 5. 依存関係

- `src/commands/spec/create.ts` - 仕様書作成コマンドの実装
- `src/core/templates/spec-template.ts` - 仕様書テンプレート生成ロジック
- `AskUserQuestion` ツール - 対話的な情報確認
- Task ツール (Explore サブエージェント) - コードベース解析
- `src/core/database/connection.ts` - データベース操作
- `src/integrations/github/sync.ts` - GitHub Issue 連携（自動作成）

---

## 6. 参考情報

- CLAUDE.md - プロジェクト開発ガイドライン
- `src/commands/spec/create.ts` - 既存の仕様書の作成実装
- `src/core/templates/spec-template.ts` - テンプレート生成ロジック

---

## 8. 実装タスクリスト

### フェーズ 1: 仕様書の自動完成ロジックの実装

- [ ] `src/commands/spec/create.ts` に仕様書の自動完成関数を追加
  - [ ] ユーザー入力（name, description）を解析
  - [ ] 背景と目的を生成する関数を実装
  - [ ] 対象ユーザーを推論する関数を実装
  - [ ] 受け入れ基準を提案する関数を実装

### フェーズ 2: コードベース解析機能の実装

- [ ] Task ツール (Explore サブエージェント) を活用したコードベース解析
  - [ ] 制約条件を既存コードから推論
  - [ ] 依存関係を既存モジュールから抽出
  - [ ] 関連する既存仕様書を検索

### フェーズ 3: 対話的な情報確認機能の実装

- [ ] `AskUserQuestion` ツールを使用した不明情報の確認
  - [ ] 不足している情報を検出
  - [ ] 質問項目を動的に生成
  - [ ] 回答を仕様書に反映

### フェーズ 4: テンプレート生成ロジックの更新

- [ ] `src/core/templates/spec-template.ts` を更新
  - [ ] 自動生成された内容を反映する形式に変更
  - [ ] プレースホルダーの削除
  - [ ] 生成された仕様書の検証

### フェーズ 5: テストとドキュメント

- [ ] 単体テストの作成（test-generator サブエージェント使用）
  - [ ] 仕様書の自動完成のテスト
  - [ ] コードベース解析のテスト
  - [ ] 対話的確認のテスト
- [ ] コードレビュー（code-reviewer サブエージェント使用）
- [ ] CLAUDE.md の更新（新機能の説明追加）
