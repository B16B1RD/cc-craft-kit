# このリポジトリのブランチ戦略を作成

**仕様書 ID:** 989aa48d-749a-4826-800b-3b6b76a303e0
**フェーズ:** design
**作成日時:** 2025/11/19 22:51:45
**更新日時:** 2025/11/19 22:57:53

---

## 1. 背景と目的

### 背景

cc-craft-kit プロジェクトでは、現在ブランチ戦略が明確に定義されていません。CLAUDE.md には基本的なブランチ命名規則（`feature/`, `bugfix/`, `refactor/`）が記載されていますが、以下の点が不明確です。

- メインブランチの運用方針（main ブランチのみか、develop ブランチも使用するか）
- PR のマージ戦略（Merge Commit, Squash, Rebase）
- リリースフロー（タグ付け、バージョニング）
- ホットフィックスの対応方法
- ブランチ保護ルールの設定

### 目的

1. 明確なブランチ戦略を策定し、開発フローを標準化する
2. CLAUDE.md に「Git ワークフロー基本方針」セクションを拡充し、チーム全体で共有可能な状態にする
3. GitHub リポジトリのブランチ保護設定を推奨する
4. cc-craft-kit の自動 Git コミット機能と整合性のある戦略を確立する

---

## 2. 対象ユーザー

- cc-craft-kit の開発者（コントリビューター）
  - コアチームメンバー
  - 外部コントリビューター
- Claude Code を使用して cc-craft-kit を利用する開発者
  - ドッグフーディング環境での開発者
- GitHub リポジトリ管理者（ブランチ保護ルールを設定する担当者）

---

## 3. 受け入れ基準

### 必須要件

- [ ] CLAUDE.md に「Git ワークフロー基本方針」セクションを拡充する
- [ ] ブランチ戦略（メインブランチ運用方針、PR マージ戦略、リリースフロー）を明記する
- [ ] ブランチ命名規則を体系的に整理する
- [ ] ブランチ保護ルールの推奨設定を記載する

### 機能要件

- [ ] メインブランチ運用方針を決定する（main のみか、main + develop か）
- [ ] PR のマージ戦略を決定する（Merge Commit / Squash / Rebase）
- [ ] リリースフロー（バージョニング、タグ付け）を定義する
  - npm バージョン管理（package.json）
  - Git タグ付け規則（セマンティックバージョニング）
  - リリースノート自動生成の有無
- [ ] ホットフィックスフローを定義する
  - 緊急修正時のブランチ戦略（hotfix/ ブランチの使用）
  - main ブランチへの直接マージ可否
- [ ] cc-craft-kit の自動 Git コミット機能との整合性を確認する
  - completed フェーズ移行時の自動コミットがブランチ戦略と整合するか検証

### 非機能要件

- [ ] 既存のコミットメッセージ規約（Conventional Commits）と整合性を保つ
  - 検証方法: CLAUDE.md のコミットメッセージ例を確認し、新しいブランチ戦略で矛盾がないことを確認
- [ ] GitHub Actions CI/CD ワークフローと連携可能な設計にする
  - 検証方法: `.github/workflows/*.yml` のブランチトリガー設定を確認し、必要に応じて修正
- [ ] ブランチ保護ルール設定により、main ブランチへの直接 push を防止する
  - 検証方法: GitHub リポジトリ設定で「Require pull request before merging」を有効化し、動作確認

---

## 4. 制約条件

- 既存のリポジトリ構造を維持する
  - main ブランチをデフォルトブランチとして継続使用する
  - 既存のコミット履歴を保持する
  - 既存のタグ・リリースを維持する
- cc-craft-kit の自動 Git コミット機能（フェーズ変更時のコミット）と整合性を保つ
- GitHub の無料プラン範囲内で実現可能なブランチ保護設定とする
- 既存の Conventional Commits 規約を継続利用する

---

## 5. 依存関係

### 影響を受けるコンポーネント

- **CLAUDE.md** の「Git ワークフロー基本方針」セクション
  - 影響: ドキュメント更新が必要
- **cc-craft-kit の自動 Git コミット機能** (`src/core/workflow/git-integration.ts`)
  - 影響: ブランチ戦略変更に伴うコード修正の可能性
- **GitHub Actions ワークフロー** (`.github/workflows/*.yml`)
  - 影響: CI/CD パイプラインのブランチトリガー設定変更の可能性
- **GitHub リポジトリ設定**
  - 影響: ブランチ保護ルール、デフォルトブランチ設定変更の可能性

### 前提条件

- 既存の main ブランチが安定していること
- GitHub リポジトリの管理者権限があること

---

## 6. 参考情報

- [Git Flow](https://nvie.com/posts/a-successful-git-branching-model/) - Vincent Driessen 氏の Git ブランチモデル
- [GitHub Flow](https://docs.github.com/en/get-started/using-github/github-flow) - GitHub 公式のシンプルなワークフロー
- [GitLab Flow](https://about.gitlab.com/topics/version-control/what-is-gitlab-flow/) - GitLab のブランチ戦略
- [Trunk Based Development](https://trunkbaseddevelopment.com/) - trunk-based な開発スタイル
- [Conventional Commits](https://www.conventionalcommits.org/) - コミットメッセージ規約
- [GitHub Branch Protection Rules](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/about-protected-branches)
  \- GitHub ブランチ保護設定
