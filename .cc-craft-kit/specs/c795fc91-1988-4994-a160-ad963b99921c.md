# ブランチ名が適当な名前になっている

**仕様書 ID:** c795fc91-1988-4994-a160-ad963b99921c
**フェーズ:** requirements
**作成日時:** 2025/11/20 19:46:36
**更新日時:** 2025/11/20 19:46:36

---

## 1. 背景と目的

### 背景

現在、cc-craft-kit は仕様書作成時に自動的に `spec/<仕様書IDの先頭8文字>` 形式のブランチを作成します。

**問題点:**

- ブランチ名から仕様書の内容が推測できない
- 例: `spec/c795fc91` では何の機能を開発しているのか不明
- GitHub や git log でブランチ一覧を見たときに識別が困難

**改善の必要性:**
仕様書の内容に沿った意味のある名前（例: `spec/c795fc91-improve-branch-naming`）により、開発効率の向上を図りたい。

### 目的

仕様書作成時に、仕様書の内容を反映した人間が読みやすいブランチ名を自動生成する機能を実装する。

**期待される効果:**

1. ブランチ一覧から開発内容が一目で把握できる
2. Git 履歴の可読性が向上する
3. チーム開発時のコミュニケーションが円滑になる

---

## 2. 対象ユーザー

- cc-craft-kit を使用して仕様駆動開発を行う開発者
- プロジェクトの Git ブランチ履歴を確認する開発者・レビュアー

---

## 3. 受け入れ基準

### 必須要件

- [ ] 仕様書名からブランチ名を自動生成できる
- [ ] 生成されたブランチ名が Git の命名規則に準拠している（英数字、ハイフン、スラッシュのみ）
- [ ] 仕様書 ID の一部（先頭 8 文字）がブランチ名に含まれる（一意性の保証）
- [ ] ブランチ名の長さが適切に制限される（最大 63 文字など）

### 機能要件

- [ ] 仕様書名に日本語が含まれる場合、適切にローマ字化またはスラッグ化される
- [ ] 特殊文字や空白が適切に置換される（例: スペース → ハイフン）
- [ ] ブランチプレフィックス `spec/` が自動的に付与される
- [ ] 既存のブランチ命名規則（CLAUDE.md で定義）と整合性が取れる

### 非機能要件

- [ ] ブランチ名生成処理が 1 秒以内に完了する
- [ ] 同じ仕様書名から常に同じブランチ名が生成される（冪等性）
- [ ] エラー時は安全にフォールバックする（現在の ID ベース命名に戻る）

---

## 4. 制約条件

- Git のブランチ名として使用可能な文字のみ使用（英数字、ハイフン、スラッシュ、アンダースコア）
- ブランチ名の最大長は 63 文字（Git の推奨値）
- 保護ブランチ（main, develop）では自動ブランチ作成をスキップする（既存仕様を維持）
- 既存の `spec/` プレフィックスを維持し、後方互換性を保つ

---

## 5. 依存関係

- `src/commands/spec/create.ts` - 仕様書作成コマンド（ブランチ作成ロジックを含む）
- `src/core/git/branch-cache.ts` - ブランチキャッシュ機構
- `src/core/database/schema.ts` - `specs` テーブル定義（`branch_name` カラム）
- CLAUDE.md で定義されたブランチ戦略との整合性

---

## 6. 参考情報

- [Git ブランチ命名のベストプラクティス](https://git-scm.com/docs/git-check-ref-format)
- CLAUDE.md セクション「ブランチ管理」（既存の仕様書作成時の自動ブランチ作成仕様）
- `src/commands/spec/create.ts` の現在の実装（`spec/<仕様書IDの先頭8文字>` 生成ロジック）
