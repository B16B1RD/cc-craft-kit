---
id: "8a73de47-5a3e-4ad8-902e-35c96aefec5c"
name: "/cft:status が正しく動作しない"
phase: "requirements"
branch_name: "fix/spec-8a73de47-status-not-working-correctly"
github_issue_number: null
pr_url: null
created_at: "2025-12-06T12:00:00.000Z"
updated_at: "2025-12-06T12:00:00.000Z"
---

# /cft:status が正しく動作しない

## 1. 背景と目的

### 背景

`/cft:status` コマンド実行時に複数のエラーが発生している:

1. **Bash コマンドの構文エラー**: `for` ループや `while read` を使用したシェルスクリプトが正しく解釈されない
   - 変数展開が空文字列になる
   - パイプとループの組み合わせでファイルパスが消失

2. **仕様書フォーマットの混在**: 195件の仕様書に2つのフォーマットが混在
   - **YAML フロントマター形式** (193件): `---` で囲まれた YAML ヘッダー
   - **独自フォーマット** (2件): `**フェーズ:**` などの Markdown 形式

3. **phase 行の不正値**: 1件の仕様書で `phase: <requirements|design|implementation|review|completed>` というテンプレート文字列がそのまま残っている

### 目的

1. `/cft:status` コマンドが正常に動作するようにする
2. 仕様書フォーマットを YAML フロントマター形式に統一する
3. 不正な phase 値を持つ仕様書を修正する

---

## 2. 対象ユーザー

cc-craft-kit を使用してプロジェクト管理を行う開発者

---

## 3. 受け入れ基準

### 必須要件

- [ ] `/cft:status` コマンドがエラーなく実行できる
- [ ] 全ての仕様書が YAML フロントマター形式に統一されている
- [ ] 不正な phase 値を持つ仕様書が修正されている

### 機能要件

- [ ] Bash コマンドの構文エラーが解消される
- [ ] 独自フォーマット（`**フェーズ:**` 形式）の仕様書が YAML フロントマター形式に移行される
- [ ] phase フィールドに有効な値のみが設定されている

### 非機能要件

- [ ] 既存の仕様書データ（内容）が失われない
- [ ] 移行スクリプトが再実行可能である

---

## 4. 制約条件

- 移行は非破壊的に行う（バックアップを作成）
- 既存のブランチ構造を維持する

---

## 5. 依存関係

- `.cc-craft-kit/specs/` 内の全仕様書ファイル
- `/cft:status` コマンド定義（`.claude/commands/cft/status.md`）

---

## 6. 参考情報

### 問題のある仕様書

**独自フォーマット（2件）:**
- `d29e6a8c-b249-4f84-9444-f988347ebcb1.md`
- `7ae68b97-e109-439f-ba52-afe3737132e8.md`

**不正な phase 値（1件）:**
- phase が `<requirements|design|implementation|review|completed>` のままの仕様書

### 現在のフェーズ分布

| フェーズ | 件数 |
|---------|------|
| completed | 187 |
| review | 5 |
| requirements | 1 |
| design | 1 |
| 不正値 | 1 |

### 発生したエラー例

```
/bin/bash: eval: 行 1: 予期しないトークン `basename' 周辺に構文エラーがあります
```

```
head: '' を 読み込み用に開くことが出来ません: そのようなファイルやディレクトリはありません
```
