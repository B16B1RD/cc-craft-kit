---
id: "b3b09ff8-fb33-4920-b4c6-499be2e8344a"
name: "開発キットの textlint と markdownlint を廃止する"
phase: "completed"
branch_name: "main"
github_issue_number: null
pr_url: null
created_at: "2025-11-22T17:31:33.089Z"
updated_at: "2025-11-23T02:54:48Z"
---

# 開発キットの textlint と markdownlint を廃止する


## 1. 背景と目的

### 背景

cc-craft-kit は現在、以下の Markdown 品質チェックツールを使用している:

- **textlint**: 日本語テクニカルライティングのスタイルチェック（技術文書向け、AI 執筆ガイドライン、スペーシング等）
- **markdownlint**: Markdown 構文の整合性チェック（行長、タグ許可、リストフォーマット等）

これらは以下の箇所で使用されている:

1. **Git 自動コミット機能** (`src/core/workflow/git-integration.ts:165-195`): 仕様書ファイルのコミット前に `runTextlintFix()` で自動修正を実行
2. **PR 自動作成機能** (`.claude/skills/pr-creator/SKILL.md`): PR 本文の品質保証のため、一時ファイルに対して textlint/markdownlint チェックを実行
3. **CI/CD** (`.github/workflows/ci.yml:48-68`): Documentation Lint ジョブでドキュメント品質をチェック
4. **Pre-commit フック** (`.husky/pre-commit` + `lint-staged`): すべての `.md` ファイルに対して textlint/markdownlint を自動実行

しかし、以下の理由により、これらのツールは開発体験を損なっている:

- Claude Code の native な Markdown 処理能力で十分なケースが多い
- textlint のルール設定が厳格すぎて、柔軟な表現を制限することがある
- CI/CD でのチェック失敗が頻繁に発生し、開発フローを妨げる
- 依存パッケージの管理コスト（5 個の devDependencies）

### 目的

textlint と markdownlint を完全に廃止し、以下を実現する:

1. **開発体験の向上**: 過度な品質チェックを削除し、柔軟な Markdown 記述を可能にする
2. **メンテナンスコストの削減**: 依存パッケージ、設定ファイル、npm scripts を削減
3. **CI/CD の高速化**: Documentation Lint ジョブを削除し、テストフローを簡素化
4. **Git 自動コミット機能の簡素化**: テキスト修正ロジックを削除し、コミットフローを安定化
---

## 2. 対象ユーザー

- **開発者**: cc-craft-kit を使用する開発者全員
- **コントリビューター**: リポジトリにコントリビュートする外部開発者
- **CI/CD**: GitHub Actions ワークフロー
---

## 3. 受け入れ基準

### 必須要件

- [ ] textlint 関連の依存パッケージ（5 個）を `package.json` から削除する
- [ ] markdownlint 関連の依存パッケージを `package.json` から削除する
- [ ] `.textlintrc.json` 設定ファイルを削除する
- [ ] `.markdownlint.json` 設定ファイルを削除する
- [ ] `src/core/workflow/git-integration.ts` から `runTextlintFix()` 関数を削除する
- [ ] `git-integration.ts` の `gitCommit()` 関数からテキスト修正ロジックを削除する
- [ ] `.github/workflows/ci.yml` から Documentation Lint ジョブを削除する

### 機能要件

- [ ] `package.json` から以下の npm scripts を削除する: `textlint`, `textlint:fix`, `markdownlint`, `markdownlint:fix`
- [ ] `lint:all` スクリプトから textlint/markdownlint の呼び出しを削除する
- [ ] `lint-staged` 設定から Markdown ファイルの textlint/markdownlint 処理を削除する
- [ ] `.claude/skills/pr-creator/SKILL.md` から textlint/markdownlint チェックの説明を削除する
- [ ] `CLAUDE.md` から `npm run textlint:fix` コマンドの記載を削除する
- [ ] `tests/core/workflow/git-integration-pr-creator.test.ts` でテキストリント関連のテストを修正または削除する

### 非機能要件

- [ ] すべてのテストが成功すること（修正後）
- [ ] 型チェック（`npx tsc --noEmit`）がエラーなく完了すること
- [ ] ESLint チェック（`npm run lint`）がエラーなく完了すること
- [ ] CI/CD が正常に動作すること（Documentation Lint ジョブ削除後）
---

## 4. 制約条件

### 技術的制約

- **TypeScript**: strict mode を有効にして、すべての型チェックを厳格に実施すること
- **Git フック**: `.husky/pre-commit` は他の ESLint・Prettier 処理も担当しているため、Markdown 処理のみ削除し、フック自体は削除しないこと
- **後方互換性**: 既存の仕様書ファイルは修正せず、そのまま保持すること（textlint エラーがあっても問題ない）

### セキュリティ制約

- すべての変更は適切にテストすること
- Git 自動コミット機能の変更により、意図しないファイルがコミットされないこと

### 運用制約

- 廃止後、Claude Code の native な Markdown 処理能力に依存すること
- Markdown 品質チェックの代替手段は導入しないこと（開発体験向上のため）
---

## 5. 依存関係

### 影響を受けるモジュール

- **Git 自動コミット機能** (`src/core/workflow/git-integration.ts`): `runTextlintFix()` 関数の削除により、Markdown ファイルの自動修正が行われなくなる
- **PR 自動作成機能** (`.claude/skills/pr-creator/SKILL.md`): PR 本文の品質チェックが削除される
- **CI/CD** (`.github/workflows/ci.yml`): Documentation Lint ジョブが削除される
- **Pre-commit フック** (`.husky/pre-commit` + `lint-staged`): Markdown ファイルの textlint/markdownlint 処理が削除される

### 削除する依存パッケージ

```json
{
  "@textlint-ja/textlint-rule-preset-ai-writing": "^1.6.1",
  "markdownlint-cli2": "^0.19.0",
  "textlint": "^14.0.5",
  "textlint-rule-preset-ja-spacing": "^2.4.3",
  "textlint-rule-preset-ja-technical-writing": "^12.0.2"
}
```

### 関連仕様書

特になし（既存の仕様書に依存しない独立した変更）
---

## 6. 参考情報

### 影響範囲の詳細

**ファイル別の変更内容:**

1. **src/core/workflow/git-integration.ts**
   - 行 165-195: `runTextlintFix()` 関数を削除
   - 行 234-250: `gitCommit()` 関数でのテキスト修正ロジックを削除
   - 行 374: PR 作成メッセージから textlint/markdownlint の記載を削除

2. **package.json**
   - devDependencies: 5 個のパッケージを削除
   - scripts: `textlint`, `textlint:fix`, `markdownlint`, `markdownlint:fix` を削除
   - scripts: `lint:all` を `npm run lint` に変更
   - lint-staged: Markdown ファイルの処理を削除

3. **.github/workflows/ci.yml**
   - 行 48-68: Documentation Lint ジョブを削除

4. **.claude/skills/pr-creator/SKILL.md**
   - textlint/markdownlint チェック説明を削除
   - エラーハンドリング関連セクションを削除
   - 制約事項を更新

5. **CLAUDE.md**
   - 行 40-42: `npm run textlint:fix` コマンドの記載を削除

6. **tests/core/workflow/git-integration-pr-creator.test.ts**
   - テキストリント関連のテストを修正

### 参考資料

- [ARCHITECTURE.md](./docs/ARCHITECTURE.md) - cc-craft-kit のアーキテクチャ
- [CLAUDE.md](./CLAUDE.md) - 開発規約
- [textlint 公式ドキュメント](https://textlint.github.io/) - 廃止するツールのドキュメント
- [markdownlint-cli2 公式ドキュメント](https://github.com/DavidAnson/markdownlint-cli2) - 廃止するツールのドキュメント
---

## 7. 設計

### 7.1 アーキテクチャ設計

#### 影響範囲の可視化

```
cc-craft-kit/
├── src/core/workflow/
│   └── git-integration.ts          # 変更: runTextlintFix() 削除
├── .claude/skills/pr-creator/
│   └── SKILL.md                    # 変更: textlint/markdownlint 説明削除
├── .github/workflows/
│   └── ci.yml                      # 変更: Documentation Lint ジョブ削除
├── package.json                    # 変更: devDependencies と scripts 削除
├── .textlintrc.json                # 削除
├── .markdownlint.json              # 削除
├── CLAUDE.md                       # 変更: textlint:fix コマンド記載削除
└── tests/core/workflow/
    └── git-integration-pr-creator.test.ts  # 変更: テスト修正
```

#### モジュール間の依存関係

1. **git-integration.ts** (`src/core/workflow/git-integration.ts`)
   - `runTextlintFix()` 関数: 削除対象
   - `gitCommit()` 関数: テキスト修正ロジック削除
   - 影響: PR 作成機能、仕様書コミット機能

2. **pr-creator スキル** (`.claude/skills/pr-creator/SKILL.md`)
   - textlint/markdownlint チェックの説明: 削除対象
   - 影響: PR 作成時の品質保証ワークフロー

3. **CI/CD** (`.github/workflows/ci.yml`)
   - Documentation Lint ジョブ: 削除対象
   - 影響: CI パイプライン全体の実行時間が短縮

### 7.2 API 設計

該当なし（API の追加・変更は行わない）

### 7.3 データモデル設計

該当なし（データベーススキーマの変更は行わない）

### 7.4 実装方針

#### 7.4.1 削除する関数・ロジック

**`src/core/workflow/git-integration.ts`**

```typescript
// 削除対象: runTextlintFix() 関数（行 165-195）
async function runTextlintFix(filePath: string): Promise<void> {
  // ... 全体を削除
}

// 削除対象: gitCommit() 関数内のテキスト修正ロジック（行 234-250）
async function gitCommit(message: string): Promise<void> {
  // ... テキスト修正ロジックを削除
  // runTextlintFix(filePath) の呼び出しを削除
}
```

**変更後の `gitCommit()` 関数**

```typescript
async function gitCommit(message: string): Promise<void> {
  // テキスト修正ロジックを削除し、単純なコミット処理のみ実行
  await execAsync(`git commit -m "${message}"`);
}
```

#### 7.4.2 package.json の変更

**削除する devDependencies:**

```json
{
  "@textlint-ja/textlint-rule-preset-ai-writing": "^1.6.1",
  "markdownlint-cli2": "^0.19.0",
  "textlint": "^14.0.5",
  "textlint-rule-preset-ja-spacing": "^2.4.3",
  "textlint-rule-preset-ja-technical-writing": "^12.0.2"
}
```

**削除する scripts:**

```json
{
  "textlint": "textlint ...",
  "textlint:fix": "textlint --fix ...",
  "markdownlint": "markdownlint-cli2 ...",
  "markdownlint:fix": "markdownlint-cli2 --fix ..."
}
```

**変更する scripts:**

```json
{
  "lint:all": "npm run lint"  // 変更前: npm run lint && npm run textlint && npm run markdownlint
}
```

**変更する lint-staged:**

```json
{
  "lint-staged": {
    "*.{ts,tsx,js,jsx}": ["eslint --fix", "prettier --write"],
    // "*.md": ["textlint --fix", "markdownlint-cli2 --fix"] を削除
  }
}
```

#### 7.4.3 CI/CD の変更

`.github/workflows/ci.yml` から以下のジョブを削除:

```yaml
# 削除対象（行 48-68）
documentation-lint:
  name: Documentation Lint
  runs-on: ubuntu-latest
  steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'npm'
    - run: npm ci
    - name: Run textlint
      run: npm run textlint
    - name: Run markdownlint
      run: npm run markdownlint
```

#### 7.4.4 テストの修正

`tests/core/workflow/git-integration-pr-creator.test.ts` で以下を修正:

- textlint/markdownlint 関連のモックを削除
- テキスト修正ロジックのテストケースを削除
- Git コミット処理のテストを簡素化

### 7.5 エラーハンドリング

#### 7.5.1 削除後のリスクと対策

| リスク | 影響 | 対策 |
|--------|------|------|
| Markdown ファイルの品質低下 | 仕様書や PR 本文の文法エラーが増える可能性 | Claude Code の native な Markdown 処理能力に依存し、レビュープロセスで品質を担保 |
| CI/CD のテスト削除 | ドキュメント品質の自動チェックが行われない | 開発体験向上を優先し、品質チェックは行わない方針 |
| Git 自動コミット機能の動作変更 | テキスト修正が行われなくなる | 仕様書ファイルはそのままコミットされる（意図的な変更） |

#### 7.5.2 ロールバック計画

万が一、廃止による影響が大きい場合は、以下の手順でロールバック可能:

1. Git でこの変更セット全体を revert
2. `npm install` で依存パッケージを再インストール
3. 設定ファイル (`.textlintrc.json`, `.markdownlint.json`) を復元
4. CI/CD ジョブを復元

### 7.6 セキュリティ設計

該当なし（セキュリティリスクは存在しない）

### 7.7 パフォーマンス設計

#### 期待される効果

- **CI/CD 実行時間の短縮**: Documentation Lint ジョブ（約 30 秒）が削除され、全体のパイプライン実行時間が短縮
- **Pre-commit フック の高速化**: Markdown ファイルの textlint/markdownlint 処理が削除され、コミット時間が短縮
- **依存パッケージの削減**: 5 個の devDependencies が削除され、`npm install` 時間が短縮

### 7.8 テスト戦略

#### 7.8.1 単体テスト

- `tests/core/workflow/git-integration-pr-creator.test.ts` でテキスト修正ロジックのテストを修正
- `gitCommit()` 関数の単純化により、テストケースが減少

#### 7.8.2 統合テスト

- CI/CD パイプライン全体が正常に動作することを確認
- Pre-commit フックが正常に動作することを確認
- 仕様書の自動コミット機能が正常に動作することを確認

#### 7.8.3 E2E テスト

該当なし（E2E テストは不要）
---

## 8. 実装タスクリスト

このセクションは、tasks フェーズで自動的に生成されます。各タスクは受け入れ基準に基づいて分解されており、実装時の進捗管理に使用します。

### 8.1 依存パッケージとファイルの削除

- [ ] textlint/markdownlint 関連の依存パッケージを package.json から削除する
- [ ] .textlintrc.json と .markdownlint.json 設定ファイルを削除する

### 8.2 npm scripts の削除

- [ ] package.json から textlint/markdownlint 関連の npm scripts を削除する
- [ ] package.json の lint-staged 設定から Markdown ファイル処理を削除する

### 8.3 Git 統合機能の修正

- [ ] src/core/workflow/git-integration.ts から runTextlintFix() 関数を削除する
- [ ] git-integration.ts の gitCommit() 関数からテキスト修正ロジックを削除する

### 8.4 CI/CD とドキュメントの更新

- [ ] .github/workflows/ci.yml から Documentation Lint ジョブを削除する
- [ ] .claude/skills/pr-creator/SKILL.md から textlint/markdownlint チェックの説明を削除する
- [ ] CLAUDE.md から npm run textlint:fix コマンドの記載を削除する

### 8.5 テストの修正

- [ ] tests/core/workflow/git-integration-pr-creator.test.ts でテストを修正する

### 8.6 品質チェック

- [ ] 型チェック (npx tsc --noEmit) を実行してエラーがないことを確認する
- [ ] ESLint チェック (npm run lint) を実行してエラーがないことを確認する
- [ ] すべてのテスト (npm test) を実行して成功することを確認する
