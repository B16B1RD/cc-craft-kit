# v0.1.5 リリース準備

**仕様書 ID:** 7441f99b-9494-4db6-b3a9-68786fb0ff5e
**フェーズ:** implementation
**作成日時:** 2025/12/02 00:00:00
**更新日時:** 2025/12/02 14:15:00

---

## 1. 背景と目的

### 背景

v0.1.4（2025-11-30）リリース以降、develop ブランチに以下の重要な実装がコミットされた:

- **セッション再開時のワークフロー状態引き継ぎ** (dbb69ff): セッションを再開した際に、前回のワークフロー状態が正しく復元されるようになった
- **プロジェクト名完全置換** (b2d308e): 旧名称「Takumi」を「cc-craft-kit」に完全置換
- **インストール方法の改善** (bf813e5): インストールスクリプトの URL 修正

また、データベースマイグレーション 012（ワークフロー状態テーブル）が追加実装済み。

現在の develop の内容を v0.1.5 としてリリースするための準備を実施し、作成済みの PR #540 を手動でマージして develop ブランチを main ブランチに統合する。

### 目的

develop ブランチの現在の内容を v0.1.5 として安定状態でリリースする。バージョン更新、ドキュメント整備、品質チェックを完了し、main ブランチへのマージと npm publish を可能にする。

---

## 2. 対象ユーザー

- cc-craft-kit を使用する開発者
- cc-craft-kit のメンテナー

---

## 3. 受け入れ基準

### 必須要件

- [ ] package.json の version を 0.1.5 に更新
- [ ] CHANGELOG.md に v0.1.5 セクションを追加（3 つの新機能を記載）
- [ ] npm run sync:dogfood で同期確認
- [ ] npm run typecheck で型チェック通過
- [ ] npm run lint でリント通過
- [ ] npm test で全テスト通過

### 機能要件

- [ ] CHANGELOG.md の v0.1.5 セクションに以下を記載:
  - Added: セッション再開時のワークフロー状態引き継ぎ
  - Added: プロジェクト名完全置換（Takumi → cc-craft-kit）
  - Added: インストール方法の改善
  - Changed: データベースマイグレーション 012 追加

### 非機能要件

- [ ] Semantic Versioning（SemVer）に準拠（0.1.4 → 0.1.5 は MINOR リリース）
- [ ] Keep a Changelog 形式に準拠

---

## 4. 制約条件

- v0.1.5 は MINOR リリースのため、後方互換性を維持する
- データベースマイグレーション 012 の既存データとの互換性を確認
- CI/CD パイプライン（lint, typecheck, test, sync-check）全体の通過が必須
- PR #540 は既存のドラフト状態で待機中（手動でマージ予定）

---

## 5. 依存関係

- **v0.1.4 リリース**: 既にリリース済み（2025-11-30）
- **データベーススキーマ 012**: `src/core/database/migrations/012_add_workflow_state.ts` 実装済み
- **GitHub Actions**: release.yml ワークフローが npm publish を自動実行
- **PR #540**: develop → main への既存 PR

---

## 6. 参考情報

- [v0.1.4 リリース仕様書](.cc-craft-kit/specs/a73061f5-855b-4733-bdb6-97827cbaa925.md)
- [CHANGELOG.md](CHANGELOG.md)
- [package.json](package.json)
- [GitHub Actions release.yml](.github/workflows/release.yml)

---

## 7. 設計詳細

### 7.1 アーキテクチャ設計

#### 全体構成

```
v0.1.5 リリース準備（ドキュメント・設定更新）

┌─────────────────────────────────────────────────────────────┐
│  修正対象ファイル                                            │
│                                                             │
│  ┌─────────────────┐  ┌─────────────────────────────────┐ │
│  │ package.json    │  │ CHANGELOG.md                    │ │
│  │ version: 0.1.5  │  │ ## [0.1.5] - 2025-12-02        │ │
│  └─────────────────┘  └─────────────────────────────────┘ │
│                                                             │
│  ※ マイグレーション 012 は既に実装済み（追加作業不要）        │
└─────────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│  品質チェック                                               │
│                                                             │
│  npm run sync:dogfood  → src/ と .cc-craft-kit/ の同期確認 │
│  npm run typecheck     → TypeScript 型チェック             │
│  npm run lint          → ESLint コード品質チェック          │
│  npm test              → 単体・統合テスト実行               │
└─────────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│  リリースフロー（手動）                                      │
│                                                             │
│  1. PR #540 をレビュー・マージ（develop → main）            │
│  2. Git タグ v0.1.5 を作成・プッシュ                        │
│  3. release.yml が自動実行 → GitHub Release 作成            │
└─────────────────────────────────────────────────────────────┘
```

#### 設計方針

- **最小限の変更**: リリース準備のため、package.json と CHANGELOG.md のみ更新
- **既存ワークフロー活用**: release.yml がタグプッシュで自動実行
- **品質保証**: CI パイプライン全体の通過を必須条件とする

#### 処理フロー詳細

```
1. package.json 更新
   └─ "version": "0.1.4" → "version": "0.1.5"

2. CHANGELOG.md 更新
   └─ ## [0.1.5] - 2025-12-02 セクションを追加
      ├─ Added: セッション再開時のワークフロー状態引き継ぎ
      ├─ Added: プロジェクト名完全置換（Takumi → cc-craft-kit）
      ├─ Added: インストール方法の改善
      └─ Changed: データベースマイグレーション 012 追加

3. 品質チェック実行
   ├─ npm run sync:dogfood（同期確認）
   ├─ npm run typecheck（型チェック）
   ├─ npm run lint（リント）
   └─ npm test（テスト）

4. コミット・プッシュ
   └─ develop ブランチに変更をコミット
```

### 7.2 実装方針

#### 修正対象ファイル

| ファイル | 変更内容 |
|---------|---------|
| `/home/autum/Projects/personal/cc-craft-kit/package.json` | version を 0.1.4 → 0.1.5 に更新 |
| `/home/autum/Projects/personal/cc-craft-kit/CHANGELOG.md` | v0.1.5 セクションを追加 |

#### CHANGELOG.md 追加内容

```markdown
## [0.1.5] - 2025-12-02

### Added

- セッション再開時にワークフロー状態を引き継ぐ `workflow_state` テーブル追加
- session-start/session-end フェーズにおけるワークフロー状態の自動保存・復元機能
- プロジェクト名完全置換（旧名称 Takumi → cc-craft-kit）
- インストールスクリプトの URL 修正

### Changed

- データベースマイグレーション 012: `workflow_state` テーブル追加
```

### 7.3 機能マッピング

| 機能 | 現在の実装 | 新しい実装 | 実装場所 |
|-----|----------|----------|---------|
| バージョン番号 | 0.1.4 | 0.1.5 | package.json |
| 変更履歴 | v0.1.4 まで記載 | v0.1.5 セクション追加 | CHANGELOG.md |
| マイグレーション | 012 実装済み | 変更なし | - |

### 7.4 テスト戦略

| テスト対象 | テスト内容 | 検証方法 |
|----------|----------|---------|
| 型チェック | TypeScript コンパイル成功 | `npm run typecheck` |
| コード品質 | ESLint ルール適合 | `npm run lint` |
| 単体テスト | 全テストケース通過 | `npm test` |
| 同期確認 | src/ と .cc-craft-kit/ の同期 | `npm run sync:dogfood` |

### 7.5 移行計画

#### Phase 1: バージョン・ドキュメント更新

1. package.json の version を 0.1.5 に更新
2. CHANGELOG.md に v0.1.5 セクションを追加

#### Phase 2: 品質チェック

1. npm run sync:dogfood で同期確認
2. npm run typecheck で型チェック
3. npm run lint でリント
4. npm test でテスト実行

---

## 8. 実装タスクリスト

### Phase 1: バージョン・ドキュメント更新

- [x] package.json の version を 0.1.5 に更新 (#556)
- [ ] CHANGELOG.md に v0.1.5 セクションを追加 (#557)

### Phase 2: 品質チェック

- [ ] npm run sync:dogfood で同期確認 (#558)
- [ ] npm run typecheck で型チェック通過 (#559)
- [ ] npm run lint でリント通過 (#560)
- [ ] npm test で全テスト通過 (#561)
