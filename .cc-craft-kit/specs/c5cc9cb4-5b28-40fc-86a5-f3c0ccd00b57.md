# /cft:pr-cleanup が正しく動作していない

**仕様書 ID:** c5cc9cb4-5b28-40fc-86a5-f3c0ccd00b57
**フェーズ:** requirements
**作成日時:** 2025/11/24 09:20:32
**更新日時:** 2025/11/24 09:20:32

---

## 1. 背景と目的

### 背景

以下の3つの問題を修正する必要があります:

1. **PR存在判定の誤り**: PR作成済みなのに「PRが作成されていません」と判定される
   - github_syncテーブルのJOIN条件が正しくない可能性
   - PR作成時のデータベース記録が不完全な可能性

2. **branch_nameカラム更新値の誤り**: PRのマージ先ブランチ名を設定すべきなのに、空文字列を設定している
   - PRがdevelopブランチにマージされた場合、branch_nameは'develop'にすべき
   - 現在は空文字列''を設定している

3. **SQLクエリの誤り**: github_syncテーブルに存在しないg.spec_idカラムを参照
   - 正しくはentity_idカラムを使用すべき

参考ログ: PR #330はdevelopブランチにマージ済み（2025-11-24T00:11:59Z）、feature/spec-a6e1c24a-add-design-implementation-rules ブランチから作成

### 目的

(この仕様の目的を記述してください)

---

## 2. 対象ユーザー

(この機能の対象ユーザーを記述してください)

---

## 3. 受け入れ基準

### 必須要件

- [ ] (必須要件1)
- [ ] (必須要件2)

### 機能要件

- [ ] (機能要件1)
- [ ] (機能要件2)

### 非機能要件

- [ ] (非機能要件1)
- [ ] (非機能要件2)

---

## 4. 制約条件

(制約条件を記述してください)

---

## 5. 依存関係

(依存する他の仕様やコンポーネントを記述してください)

---

## 6. 参考情報

- (参考資料やリンク)
