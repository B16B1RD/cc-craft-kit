# 作成済みの GitHub Issue が認識されない問題が解決していない

**仕様書 ID:** 3e313ec5-5349-4138-aea7-0e2fd97ff618
**フェーズ:** requirements
**作成日時:** 2025/11/30 12:00:00
**更新日時:** 2025/11/30 12:00:00

---

## 1. 背景と目的

### 背景

GitHub Issue があるにもかかわらず「Step 3.5: GitHub Issue 連携状態確認 - GITHUB_ISSUE_NUMBER が null のため、警告を表示します。」というメッセージが表示され処理を中断するか無視して継続するかの質問がされる。

### 目的

`/cft:spec-phase` コマンド実行時に、作成済みの GitHub Issue が正しく認識され、不要な警告や確認ダイアログが表示されないようにする。

---

## 2. 対象ユーザー

cc-craft-kit を使用して仕様駆動開発（SDD）を行う開発者

---

## 3. 受け入れ基準

### 必須要件

- [ ] `resolve-id.ts` で `github_number` カラムを正しく SELECT する
- [ ] `/cft:spec-phase` 実行時に作成済み Issue が認識される

### 機能要件

- [ ] `npx tsx .cc-craft-kit/commands/spec/resolve-id.ts <spec-id>` が正しい `github_issue_number` を返す
- [ ] フェーズ移行時に不要な「GitHub Issue なしで移行しますか？」の確認が表示されない

### 非機能要件

- [ ] 既存のテストが全て通過する
- [ ] 修正後に `npm run sync:dogfood` で `.cc-craft-kit/` に同期される

---

## 4. 制約条件

- 既存の `github_sync` テーブルスキーマを変更しない（後方互換性維持）
- `issue_number` カラムの削除は別タスクとして分離する
- Kysely のパラメータ化クエリを使用する

---

## 5. 依存関係

- `src/commands/spec/resolve-id.ts` - 仕様書 ID 解決スクリプト（修正対象）
- `src/core/database/schema.ts` - データベーススキーマ定義
- `src/core/database/migrations/007_add_unique_constraint_to_github_sync.ts` - github_sync テーブル定義

---

## 6. 参考情報

- 関連 Issue: #448 (GitHub Sub Issue が更新されない)
- 根本原因: `resolve-id.ts` 行 69 で旧カラム名 `issue_number` を SELECT している
- 修正箇所: `select(['issue_number'])` → `select(['github_number'])`
