# /cft:spec-phase コマンドの見直し

**仕様書 ID:** 7d808ccf-23d0-4dfe-9fa9-0d33e81f5098
**フェーズ:** requirements
**作成日時:** 2025-11-25 12:00
**更新日時:** 2025-11-25 12:00

---

## 1. 背景と目的

### 背景

現在、多くの部分がスクリプトで実現されていて、なかなか仕様通りに動作していない。プロンプト指示だと簡単にできることができていない。たいていの処理は、プロンプト指示の方が上手くいく。カスタムスラッシュコマンド→スキル→サブエージェントの構成が上手く実現できていない。改めて、Claude Code のカスタムスラッシュコマンド、スキル、サブエージェントの各機能の仕様についてよく考えて、スクリプトを使わずに仕様を実現できるか再設計して欲しい。スクリプトは最終手段です。ただし、スキル内のスクリプトは OK です。

### 目的

/cft:spec-phase コマンドをプロンプトファースト原則に従って再設計し、スクリプト依存を最小化してカスタムスラッシュコマンド・スキル・サブエージェントの連携を適切に実現する。

---

## 2. 対象ユーザー

- cc-craft-kit を使用する開発者
- 仕様駆動開発（SDD）を実践するチーム

---

## 3. 受け入れ基準

### 必須要件

- [ ] /cft:spec-phase コマンドがプロンプトベースで動作すること
- [ ] スクリプト呼び出しは DB 操作など最小限に抑えること
- [ ] カスタムスラッシュコマンド→スキル→サブエージェントの連携が正しく機能すること

### 機能要件

- [ ] フェーズ遷移の検証がプロンプト内で実行できること
- [ ] Git 操作（ブランチ作成、コミット、PR 作成）がプロンプト指示で実行できること
- [ ] 仕様書のバリデーションがプロンプト内で実行できること
- [ ] completed フェーズ移行時の PR 作成が正しく動作すること

### 非機能要件

- [ ] 既存の仕様書との互換性を維持すること
- [ ] エラーメッセージが分かりやすいこと

---

## 4. 制約条件

- プロンプトファースト原則に従う（スクリプトは最終手段）
- スキル内のスクリプトは許容される
- 既存の DB スキーマは変更しない

---

## 5. 依存関係

- Claude Code のカスタムスラッシュコマンド機能
- Claude Code のスキル機能
- Claude Code のサブエージェント機能（Task ツール）
- pr-creator スキル
- git-operations スキル

---

## 6. 参考情報

- 現在の実装: src/slash-commands/spec-phase.md
- 現在のスクリプト: src/commands/spec/phase.ts
- CLAUDE.md のプロンプトファースト原則セクション
