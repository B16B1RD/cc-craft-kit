---
id: "09b2c271-a89e-4eb1-811f-2ebabcfce1d4"
name: "/cft:status と /cft:spec list で他ブランチの仕様書が表示されない"
phase: "requirements"
branch_name: "fix/spec-09b2c271-status-list-show-all-branches"
github_issue_number: null
pr_url: null
created_at: "2025-12-07T07:15:00.000Z"
updated_at: "2025-12-07T07:15:00.000Z"
---

# /cft:status と /cft:spec list で他ブランチの仕様書が表示されない

## 1. 背景と目的

### 背景

現在の `/cft:status` および `/cft:spec list` コマンドは、**現在のブランチにあるファイルのみ** を対象に仕様書を集計・表示している。

これにより、以下の問題が発生する:

1. **作業ブランチの仕様書が見えない**: `develop` ブランチにいる場合、`fix/spec-xxx` ブランチで作成された仕様書がカウント・表示されない
2. **プロジェクト全体の状況が把握できない**: 複数の作業ブランチで並行開発している場合、全体像が見えない
3. **仕様書の重複作成リスク**: 他ブランチにある仕様書の存在に気づかず、同じ内容の仕様書を作成してしまう可能性がある

**実例:**
- `fix/spec-bcc860f0-status-phase-count-incorrect` ブランチで作成した仕様書 `bcc860f0` が、`develop` ブランチからは見えない
- `/cft:status` で requirements: 1 件と表示されるが、実際には別ブランチに requirements フェーズの仕様書が追加で存在する

### 目的

`/cft:status` および `/cft:spec list` コマンドで、すべてのローカルブランチにある仕様書を集計・表示できるようにする。

---

## 2. 対象ユーザー

cc-craft-kit を使用して仕様駆動開発を行う開発者

---

## 3. 受け入れ基準

### 必須要件

- [ ] `/cft:status` で全ブランチの仕様書がカウントされる
- [ ] `/cft:spec list` で全ブランチの仕様書が表示される
- [ ] 現在のブランチにない仕様書には、所属ブランチ情報が表示される

### 機能要件

- [ ] `spec-` を含むブランチ名から仕様書ファイルを検索
- [ ] 各仕様書の YAML フロントマター内 `branch_name` フィールドを活用
- [ ] 重複排除: 同じ仕様書が複数ブランチにある場合は1件としてカウント
- [ ] ブランチ情報の表示: 現在のブランチ以外の仕様書には `[branch-name]` を付与

### 非機能要件

- [ ] 多数のブランチ（20件以上）があっても高速に処理できる
- [ ] TypeScript を使用しない（スラッシュコマンドのみで実装）

---

## 4. 制約条件

- スラッシュコマンド（.md ファイル）のみで実装
- TypeScript は使用しない
- gh CLI と標準的な Unix コマンド（git, grep, sed, awk 等）のみ使用可能

---

## 5. 依存関係

- `.claude/commands/cft/spec.md` - list サブコマンドの実装
- `.claude/commands/cft/status.md` - status コマンドの実装
- 関連 Issue: bcc860f0 (フェーズ件数集計の問題) - この仕様書で併せて対応

---

## 6. 参考情報

- 仕様書の YAML フロントマターには `branch_name` フィールドがあり、作成時のブランチ名が記録されている
- `git show <branch>:<file>` で他ブランチのファイル内容を取得可能
- `git for-each-ref --format='%(refname:short)' refs/heads/` でローカルブランチ一覧を取得可能
