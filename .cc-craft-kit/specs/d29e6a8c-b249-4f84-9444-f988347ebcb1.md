# /cft:status が機能していない

**仕様書 ID:** d29e6a8c-b249-4f84-9444-f988347ebcb1
**フェーズ:** requirements
**作成日時:** 2025/12/05 16:30:00
**更新日時:** 2025/12/05 16:30:00

---

## 1. 背景と目的

### 背景

cc-craft-kit v0.1.5 でデータベース機能（SQLite + Kysely）を完全削除し、JSON ストレージベースに移行した。しかし、`/cft:status` コマンドのプロンプト定義（`src/slash-commands/status.md`）には、削除済みの機能への参照が残っている:

1. **database-schema-validator スキル呼び出し**: DB 整合性チェックステップで呼び出されるが、DB が存在しないため意味不明な出力となる
2. **--verbose オプションの DB 情報表示**: `db/info.ts` を参照するが、該当ファイルは存在しない
3. **仕様書状況の不整合**: specs.json には completed フェーズの仕様書が 0 件だが、実際のファイル（`.cc-craft-kit/specs/*.md`）には 178 件の completed 仕様書が存在する

### 目的

`/cft:status` コマンドを JSON ストレージベースのアーキテクチャに適合させ、正確なプロジェクト状況を表示できるようにする。

---

## 2. 対象ユーザー

cc-craft-kit を使用して仕様駆動開発（SDD）を行う開発者

---

## 3. 受け入れ基準

### 必須要件

- [ ] `/cft:status` 実行時に「Database Schema Validation Report」が表示されない
- [ ] 仕様書状況でファイルベースの正確なフェーズ別集計が表示される
- [ ] completed フェーズの仕様書数が正しく表示される

### 機能要件

- [ ] `status.md` から database-schema-validator スキル呼び出しを削除
- [ ] `status.md` の --verbose オプションを JSON ストレージ対応に修正
- [ ] 仕様書ファイルからフェーズ情報を読み取る仕組みの実装または修正

### 非機能要件

- [ ] 既存の `/cft:status` コマンドの出力フォーマットを維持
- [ ] パフォーマンス: 仕様書が 200 件以上でも 5 秒以内に結果を表示

---

## 4. 制約条件

- データベース（SQLite + Kysely）は使用しない（削除済み）
- JSON ストレージ（`.cc-craft-kit/meta/specs.json`）をメタデータソースとして使用
- 仕様書ファイル（`.cc-craft-kit/specs/*.md`）との整合性を維持

---

## 5. 依存関係

- `src/slash-commands/status.md` - ステータスコマンドのプロンプト定義
- `src/core/storage/` - JSON ストレージモジュール
- `.cc-craft-kit/commands/status/` - CLI 実装
- `src/skills/database-schema-validator/` - 削除対象のスキル参照

---

## 6. 参考情報

- 関連コミット: `02e52a0` - "chore: .cc-craft-kit/ から残存していた database ファイルを削除"
- 関連コミット: `1640412` - "refactor: データベース機能を完全削除し JSON ストレージへ移行"
- JSON ストレージ実装: `src/core/storage/specs-storage.ts`
