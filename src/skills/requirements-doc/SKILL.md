---
name: requirements-doc
description: 仕様書から要件定義書（Markdown形式）を自動生成します。SDD ワークフローの requirements フェーズで使用します。
---

# Requirements Document Generator Skill

仕様書の情報から構造化された要件定義書を生成するスキルです。

## Capabilities

- **要件定義書生成**: 仕様書から標準フォーマットの要件定義書を生成
- **受入基準の整理**: 仕様書の要件から受入基準を抽出・整理
- **制約条件の明確化**: 技術的・ビジネス的制約を文書化
- **依存関係の可視化**: 外部依存を明確にリスト化

## Usage

### 入力要件

以下の情報を仕様書から収集:

1. **仕様名**: 機能・プロジェクトの名称
2. **説明**: 概要説明（1-3 文）
3. **機能要件**: 実装すべき機能のリスト
4. **非機能要件** (オプション): パフォーマンス、セキュリティ等
5. **受入基準**: 完了を判定する基準のリスト
6. **制約条件** (オプション): 技術的・ビジネス的制約
7. **依存関係** (オプション): 外部システム・ライブラリへの依存

### 出力形式

生成される要件定義書は以下の構造を持ちます:

```markdown
# 要件定義書: {仕様名}

**作成日時:** {ISO 8601形式}
**作成者:** {ユーザー名 または system}

---

## 📋 概要

{説明}

## 🎯 機能概要

{機能の詳細説明}

## 👥 対象ユーザー

- {ユーザータイプ1}
- {ユーザータイプ2}

## ✅ 受け入れ基準 (Acceptance Criteria)

1. {受入基準1}
2. {受入基準2}
3. {受入基準3}

## 📐 制約条件

- {制約1}
- {制約2}

## 🔗 依存関係

- {依存1}
- {依存2}

---

## 📝 備考

- この要件定義書は、仕様駆動開発(SDD)のRequirementsフェーズで作成されました。
- 次のフェーズ: **Design** (設計フェーズ)
- 変更が必要な場合は、この文書を更新し、承認プロセスを経てください。

---

**cc-craft-kit** で生成 - 要件定義書テンプレート v1.0
```

## 実行手順

### Step 1: 仕様書の読み込み

仕様書ファイル（`.cc-craft-kit/specs/{spec-id}.md`）を Read ツールで読み込み、以下の情報を抽出:

- `## 1. 概要` セクションから説明を取得
- `## 2. 背景・目的` セクションから機能概要を取得
- `## 4. 機能要件` セクションから受入基準の基礎を取得
- `## 5. 非機能要件` セクションから制約条件を取得

### Step 2: 対象ユーザーの特定

仕様書の内容から対象ユーザーを推測:

| コンテキスト | 対象ユーザー例 |
|-------------|---------------|
| CLI ツール | 開発者、DevOps エンジニア |
| Web アプリ | エンドユーザー、管理者 |
| API | 外部システム、開発者 |
| ライブラリ | 開発者 |

### Step 3: 受入基準の生成

機能要件から受入基準を生成するルール:

1. **動詞で始める**: 「〜できること」「〜が表示されること」
2. **測定可能にする**: 具体的な数値や状態を含める
3. **1 項目 1 基準**: 複合的な基準は分割

例:
- 機能要件: 「ユーザー認証機能」
- 受入基準:
  1. ユーザーがメールアドレスとパスワードでログインできること
  2. ログイン失敗時にエラーメッセージが表示されること
  3. 3 回連続でログイン失敗した場合、10 分間ロックされること

### Step 4: 制約条件の整理

制約条件は以下のカテゴリで整理:

| カテゴリ | 例 |
|---------|---|
| 技術的制約 | 「Node.js 18 以上が必要」「SQLite を使用」 |
| パフォーマンス | 「応答時間 200ms 以内」「同時接続 100 ユーザー」 |
| セキュリティ | 「認証必須」「データ暗号化」 |
| 運用 | 「24/7 稼働」「日次バックアップ」 |

### Step 5: ドキュメント生成

1. **日時の生成**: 現在日時を `YYYY/MM/DD HH:mm` 形式で取得
2. **テンプレート適用**: 上記の出力形式に従ってドキュメントを生成
3. **ファイル保存** (オプション): Write ツールで `.cc-craft-kit/docs/` に保存

## Examples

### 例 1: API 機能の要件定義

**入力情報**:
- 仕様名: ユーザー管理 API
- 説明: ユーザーの CRUD 操作を提供する REST API
- 機能要件:
  - ユーザー登録
  - ユーザー情報取得
  - ユーザー情報更新
  - ユーザー削除
- 受入基準:
  - POST /users でユーザーを作成できること
  - GET /users/:id でユーザー情報を取得できること
  - PUT /users/:id でユーザー情報を更新できること
  - DELETE /users/:id でユーザーを削除できること

**生成される要件定義書**:

```markdown
# 要件定義書: ユーザー管理 API

**作成日時:** 2025/12/05 10:30
**作成者:** developer

---

## 📋 概要

ユーザーの CRUD 操作を提供する REST API

## 🎯 機能概要

ユーザー管理の基本機能（登録・取得・更新・削除）を REST API として提供し、
フロントエンドや他のサービスからユーザー情報を操作可能にする。

## 👥 対象ユーザー

- フロントエンド開発者
- 外部システム連携担当者
- API 利用者

## ✅ 受け入れ基準 (Acceptance Criteria)

1. POST /users でユーザーを作成できること
2. GET /users/:id でユーザー情報を取得できること
3. PUT /users/:id でユーザー情報を更新できること
4. DELETE /users/:id でユーザーを削除できること
5. 認証なしのリクエストは 401 エラーを返すこと
6. 存在しないユーザーへのアクセスは 404 エラーを返すこと

## 📐 制約条件

- RESTful API 設計原則に従う
- JSON 形式でリクエスト・レスポンス
- JWT 認証必須

## 🔗 依存関係

- データベース（SQLite）
- 認証サービス

---

## 📝 備考

- この要件定義書は、仕様駆動開発(SDD)のRequirementsフェーズで作成されました。
- 次のフェーズ: **Design** (設計フェーズ)
- 変更が必要な場合は、この文書を更新し、承認プロセスを経てください。

---

**cc-craft-kit** で生成 - 要件定義書テンプレート v1.0
```

### 例 2: CLI ツールの要件定義

**入力情報**:
- 仕様名: 設定ファイルバリデーター
- 説明: YAML/JSON 設定ファイルの構文検証ツール

**生成される要件定義書**:

```markdown
# 要件定義書: 設定ファイルバリデーター

**作成日時:** 2025/12/05 10:35
**作成者:** developer

---

## 📋 概要

YAML/JSON 設定ファイルの構文検証ツール

## 🎯 機能概要

開発・運用で使用する設定ファイル（YAML、JSON）の構文エラーを
デプロイ前に検出し、設定ミスによる障害を防止する。

## 👥 対象ユーザー

- 開発者
- DevOps エンジニア
- CI/CD パイプライン

## ✅ 受け入れ基準 (Acceptance Criteria)

1. YAML ファイルの構文エラーを検出できること
2. JSON ファイルの構文エラーを検出できること
3. エラー箇所（行番号、列番号）を表示できること
4. 複数ファイルを一括検証できること
5. 終了コードでエラー有無を判定できること（CI 連携用）

## 📐 制約条件

- Node.js 18 以上
- コマンドライン実行

## 🔗 依存関係

外部依存は特にありません。

---

## 📝 備考

- この要件定義書は、仕様駆動開発(SDD)のRequirementsフェーズで作成されました。
- 次のフェーズ: **Design** (設計フェーズ)
- 変更が必要な場合は、この文書を更新し、承認プロセスを経てください。

---

**cc-craft-kit** で生成 - 要件定義書テンプレート v1.0
```

## Best Practices

1. **受入基準は具体的に**: 「動作すること」ではなく「〜の場合に〜となること」
2. **制約条件は現実的に**: 達成不可能な制約は避ける
3. **依存関係は明示的に**: 暗黙の依存を避け、すべて列挙
4. **対象ユーザーを意識**: 誰のための機能かを明確に

## 関連スキル

- `architecture-diagram`: 設計図の生成（Design フェーズ）
- `database-schema-validator`: スキーマ検証

## cc-craft-kit Integration

### 呼び出し方法

```bash
# Skill ツールで実行
Skill(requirements-doc)
```

### 関連コマンド

| コマンド | 説明 |
|---------|------|
| `/cft:spec-create` | 仕様書の新規作成 |
| `/cft:spec-phase` | フェーズ移行（requirements → design） |
| `/cft:spec-get` | 仕様書の詳細表示 |
